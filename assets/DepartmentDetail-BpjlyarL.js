var B=Object.defineProperty;var V=(e,t,m)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):e[t]=m;var c=(e,t,m)=>V(e,typeof t!="symbol"?t+"":t,m);import{J as S,d as P,g as U,r as g,e as O,G as k,_ as I,j as i,m as L,o as M,w as p,b as n,k as r,v as h,t as C}from"./index-whgfsyUy.js";import{c as R}from"./crudBaseStore-afhvnkno.js";import{d as _}from"./departmentAPI-BR-nXrcB.js";import{B as w}from"./BaseDetail-2bx4aSjb.js";import{M as A}from"./MsComboboxTreeV2-Dc_yCRuJ.js";import{u as T}from"./remoteCombobox-B8Q4up6i.js";import"./validateComponent-B7XtBPe1.js";const y=new R({field:{key:"department_id",code:"department_code"}},_);class q{constructor(){c(this,"state",()=>({...y.state}));c(this,"actions",{...y.actions})}}const N=new q,j=S("moduleDepartment",N),z=P({mixins:[],components:{MsComboboxTreeV2:A},extends:w,setup(){const{proxy:e}=U(),t=j(),m=g(_),f=g("department"),d=O({department_code:[],user:[]}),{comboboxLoadData:b}=T(),l=async()=>{var $,F;const a=e,s={PageIndex:0,PageSize:0,Columns:"*",Filter:"",Sort:"",CustomParam:{}};a.$ms.commonFn.mask();const o=await _.getList(s);a.$ms.commonFn.unmask(),o!=null&&o.Success&&((F=($=o==null?void 0:o.Data)==null?void 0:$.PageData)!=null&&F.length)&&(a.editMode==a.$ms.constant.FormState.Add?d.department_code=o.Data.PageData:d.department_code=a.$ms.commonFn.deleteHierarchyTree(o.Data.PageData,"parent_id","department_id",a._formParam.dataRow.department_id))};return{api:m,userAPI:k,storeModule:t,subSystemCode:f,comboBoxDataRemote:d,filterInactive:a=>{const s=e;if(s.editMode==s.$ms.constant.FormState.Add){const o=["is_active","=",!0];s.$ms.commonFn.concatFilter(a,o)}},beforeBindData:async()=>{const a=e;await l(),await a.super("beforeBindData",w)},comboboxLoadData:b,selectedUserList:a=>{const s=e;s.model.user_name=a.newData?a.newData.user_name:null,s.model.user_full_name=a.newData?a.newData.user_full_name:null}}}}),E={ref:"slot-content",class:"form-content-popup"},G={class:"form-container mt-4"},H={class:"form-detail flex-center"},J={class:"form-item"},W={class:"form-item_input"},K={class:"form-group ms-small"},Q={class:"form-group ms-big"},X={class:"form-item_input"},Y={class:"form-group"},Z={class:"form-item_input"},x={class:"form-group"},ee={class:"form-action"},te={class:"form-action_container"},oe={class:"form-action_item"},ae={class:"form-action_item"};function ne(e,t,m,f,d,b){const l=i("ms-input"),D=i("ms-combobox-tree-v2"),v=i("ms-combobox-v2"),u=i("ms-button"),a=i("ms-dynamic-popup");return M(),L(a,{width:700,height:450,title:`${e.editMode?e.$ms.commonFn.getEnumResource(e.editMode,"FormState"):""} ${e.$t("i18nDepartment.Title")}`,onBeforeOpen:e.beforeOpen},{content:p(({close:s})=>[n("div",E,[n("div",G,[n("div",H,[n("div",J,[n("div",W,[n("div",K,[r(l,{maxLength:30,rules:[{name:"required"}],label:e.$t("i18nDepartment.Detail.department_code"),modelValue:e.model.department_code,"onUpdate:modelValue":t[0]||(t[0]=o=>e.model.department_code=o)},null,8,["label","modelValue"])]),n("div",Q,[r(l,{maxLength:150,rules:[{name:"required"}],label:e.$t("i18nDepartment.Detail.department_name"),modelValue:e.model.department_name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.model.department_name=o)},null,8,["label","modelValue"])])]),n("div",X,[n("div",Y,[r(D,{label:e.$t("i18nDepartment.Detail.parent"),data:e.comboBoxDataRemote.department_code,displayField:"department_name",valueField:"department_id",idProperty:"department_id",modelValue:e.model.parent_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e.model.parent_id=o),columns:[{title:e.$t("i18nDepartment.Detail.department_code"),dataField:"department_code",width:260},{title:e.$t("i18nDepartment.Detail.department_name"),dataField:"department_name",width:null}]},null,8,["label","data","modelValue","columns"])])]),n("div",Z,[n("div",x,[r(v,{label:e.$t("i18nDepartment.Detail.manager"),valueField:"user_id",displayField:"user_full_name",data:e.comboBoxDataRemote.user,initText:e.model.user_full_name,onComboboxLoadData:t[3]||(t[3]=o=>e.comboboxLoadData(o,e.userAPI,e.comboBoxDataRemote,"user")),onSelected:e.selectedUserList,buildFilter:e.filterInactive,dropdownWidth:730,columns:[{title:e.$t("i18nUser.Detail.user_name"),dataField:"user_name",width:160,filterOperator:e.$ms.constant.FilterOperator.Contains},{title:e.$t("i18nUser.Detail.user_full_name"),dataField:"user_full_name",width:200,filterOperator:e.$ms.constant.FilterOperator.Contains},{title:e.$t("i18nUser.Detail.phone_number"),dataField:"phone_number",width:140,filterOperator:e.$ms.constant.FilterOperator.Contains},{title:e.$t("i18nUser.Detail.email"),dataField:"email",width:220,filterOperator:e.$ms.constant.FilterOperator.Contains}],queryMode:"remote",remoteFilter:!0,modelValue:e.model.manager,"onUpdate:modelValue":t[4]||(t[4]=o=>e.model.manager=o),display:e.model.user_full_name,"onUpdate:display":t[5]||(t[5]=o=>e.model.user_full_name=o)},null,8,["label","data","initText","onSelected","buildFilter","columns","modelValue","display"])])])])])])],512)]),footer:p(({close:s})=>[n("div",ee,[n("div",te,[n("div",oe,[r(u,{onClick:s},{default:p(()=>[h(C(e.$t("i18nCommon.Close")),1)]),_:2},1032,["onClick"])]),n("div",ae,[r(u,{onClick:e.save,class:"primary"},{default:p(()=>[h(C(e.$t("i18nCommon.crud.save")),1)]),_:1},8,["onClick"])])])])]),_:1},8,["title","onBeforeOpen"])}const ce=I(z,[["render",ne],["__scopeId","data-v-14b5e0a2"]]);export{ce as default};
