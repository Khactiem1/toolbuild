import{v as N}from"./validateComponent-B7XtBPe1.js";import{d as g,g as V,r as p,G as k,D as C,_ as b,j as f,m as h,o as U,w as d,b as n,k as l,v as P,t as $,n as c}from"./index-whgfsyUy.js";const D=g({mixins:[N],props:{},setup(){const{proxy:s}=V(),a=p("password"),w=p("password"),_=p("password"),t=p({user_id:null,password:null,password_new:null,password_new_confirm:null}),y=async()=>{const e=s;if(await r()){e.$ms.commonFn.mask();const o=await k.changePassword(t.value);e.$ms.commonFn.unmask(),o!=null&&o.Success&&(o!=null&&o.Data)?(e.$ms.commonFn.pushNotification({type:e.$ms.constant.ENotificationType.Success,message:e.$t("i18nUser.Detail.change_password_success")}),u()):C(e.$t("i18nUser.Detail.is_valid_password"))}},r=async()=>{const e=s;return await e.validateComponents()?t.value.password_new!=t.value.password_new_confirm?(C(e.$t("i18nUser.Detail.not_access_password")),!1):!0:!1},i=e=>{var v;const o=s;if(setTimeout(()=>{o.$ms.commonFn.focusFirstControl(o.$refs["slot-content"])},100),o._popup=o.$vfm.dynamicModals[o.$vfm.dynamicModals.length-1],o._formParam=e.ref.params._rawValue?e.ref.params._rawValue:e.ref.params,(v=o._formParam)!=null&&v.user_id)t.value.user_id=o._formParam.user_id;else{const m=o.$ms.commonFn.getUser();m!=null&&m.user_id&&(t.value.user_id=m.user_id)}},u=()=>{try{const e=s;e._popup.value=!1,e.$nextTick(()=>{delete e._popup})}catch(e){console.error(e)}};return{model:t,typePass:a,typePassNew:w,typePassNewConfirm:_,save:y,beforeOpen:i}}}),F={ref:"slot-content",class:"form-content-popup"},B={class:"form-container mt-4"},O={class:"form-group"},S={class:"form-group"},T={class:"form-group"},q={class:"form-action"},I={class:"form-action_container"},E={class:"form-action_item"},M={class:"form-action_item"};function j(s,a,w,_,t,y){const r=f("ms-input"),i=f("ms-button"),u=f("ms-dynamic-popup");return U(),h(u,{width:500,height:450,title:s.$t("i18nCommon.ChangePass"),onBeforeOpen:s.beforeOpen},{content:d(({close:e})=>[n("div",F,[n("div",B,[n("div",O,[l(r,{rules:[{name:"required"}],label:s.$t("i18nUser.Detail.password"),modelValue:s.model.password,"onUpdate:modelValue":a[0]||(a[0]=o=>s.model.password=o),type:s.typePass},null,8,["label","modelValue","type"]),n("i",{class:c(["eye",s.typePass]),onClick:a[1]||(a[1]=()=>{s.typePass==="password"?s.typePass="text":s.typePass="password"})},null,2)]),n("div",S,[l(r,{rules:[{name:"required"}],label:s.$t("i18nUser.Detail.password_new"),modelValue:s.model.password_new,"onUpdate:modelValue":a[2]||(a[2]=o=>s.model.password_new=o),type:s.typePassNew},null,8,["label","modelValue","type"]),n("i",{class:c(["eye",s.typePassNew]),onClick:a[3]||(a[3]=()=>{s.typePassNew==="password"?s.typePassNew="text":s.typePassNew="password"})},null,2)]),n("div",T,[l(r,{rules:[{name:"required"}],label:s.$t("i18nUser.Detail.password_new_confirm"),modelValue:s.model.password_new_confirm,"onUpdate:modelValue":a[4]||(a[4]=o=>s.model.password_new_confirm=o),type:s.typePassNewConfirm},null,8,["label","modelValue","type"]),n("i",{class:c(["eye",s.typePassNewConfirm]),onClick:a[5]||(a[5]=()=>{s.typePassNewConfirm==="password"?s.typePassNewConfirm="text":s.typePassNewConfirm="password"})},null,2)])])],512)]),footer:d(({close:e})=>[n("div",q,[n("div",I,[n("div",E,[l(i,{onClick:e},{default:d(()=>[P($(s.$t("i18nCommon.Close")),1)]),_:2},1032,["onClick"])]),n("div",M,[l(i,{onClick:s.save,class:"primary"},{default:d(()=>[P($(s.$t("i18nCommon.crud.save")),1)]),_:1},8,["onClick"])])])])]),_:1},8,["title","onBeforeOpen"])}const G=b(D,[["render",j],["__scopeId","data-v-016fbffe"]]);export{G as default};
