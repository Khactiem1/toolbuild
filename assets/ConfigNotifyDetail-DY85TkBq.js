var P=Object.defineProperty;var A=(e,o,r)=>o in e?P(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r;var D=(e,o,r)=>A(e,typeof o!="symbol"?o+"":o,r);import{J as B,d as I,g as T,r as R,e as M,B as q,G as j,_ as O,j as y,m as E,o as C,w as f,b as i,k as s,v as g,t as m,a as V,p as G,F as J,l as z}from"./index-whgfsyUy.js";import{c as H}from"./crudBaseStore-afhvnkno.js";import{c as w}from"./configNotifyAPI-DIwtciev.js";import{B as Y}from"./BaseDetail-2bx4aSjb.js";import{u as K}from"./remoteCombobox-B8Q4up6i.js";import{d as Q}from"./dictionaryAPI-CC-qEnNc.js";import{p as W}from"./popupUtil-BcxEQbku.js";import"./validateComponent-B7XtBPe1.js";const L=new H({field:{key:"config_notify_id",code:"config_notify_code"}},w);class X{constructor(){D(this,"state",()=>({...L.state}));D(this,"actions",{...L.actions})}}const Z=new X,x=B("moduleConfigNotify",Z),ee=I({mixins:[],extends:Y,setup(){const{proxy:e}=T(),o=x(),r=R(w),$=R("notify_config"),{comboboxLoadData:h}=K(),N=M({list_channel:[],notify_type:[],screen_code:[],function:[]}),u=n=>{n.CustomParam||(n.CustomParam={}),n.CustomParam.ViewName='"SYS".channel',n.CustomParam.columns="channel_code,channel_name"},d=n=>{const l=e;if(l.editMode==l.$ms.constant.FormState.Add){const a=["is_active","=",!0];l.$ms.commonFn.concatFilter(n,a)}},b=n=>{const l=e;d(n);const a=["dictionary_list_code","=","LoaiGuiNotify"];l.$ms.commonFn.concatFilter(n,a)},c=n=>{const l=e;d(n);const a=["dictionary_list_code","=","ManHinhNotify"];l.$ms.commonFn.concatFilter(n,a)},F=n=>{const l=e;d(n);const a=["dictionary_list_code","=","ChucNang"];l.$ms.commonFn.concatFilter(n,a)},_=n=>{const l=e;l.model.receiver_ids=n.map(a=>a.user_id).join(";"),p()},p=async()=>{var k,U;const n=e;if(!n.model.receiver_ids){n.model.ReceiverDetail=[];return}const l=["user_id","in",n.model.receiver_ids.split(";")],a={PageIndex:0,PageSize:0,Columns:"user_id,user_name,user_code,user_full_name,phone_number",Filter:JSON.stringify(l)};n.$ms.commonFn.mask();let v=await j.getList(a);n.$ms.commonFn.unmask(),(U=(k=v==null?void 0:v.Data)==null?void 0:k.PageData)!=null&&U.length&&(n.model.ReceiverDetail=v.Data.PageData)};return{api:r,storeModule:o,subSystemCode:$,dataCombobox:N,dictionaryAPI:Q,comboboxLoadData:h,buildFilterComboboxChannel:u,filterType:b,filterScreen:c,filterFunction:F,openSelectUser:()=>{const l={selectedUser:_,receiver_ids:e.model.receiver_ids};W.show("ReceiveSelectUser",l)},deleteAllRow:async()=>{const n=e;await q(n.$t("i18nCommon.AskDeleteRecord"))&&(n.model.receiver_ids="",n.model.ReceiverDetail=[])},afterBindData:async()=>{p()},deleteRow:n=>{const l=e;l.model.ReceiverDetail=l.model.ReceiverDetail.filter(a=>a.user_id!=n.user_id),l.model.receiver_ids=l.model.ReceiverDetail.map(a=>a.user_id).join(";")}}}}),oe={ref:"slot-content",class:"form-content-popup"},te={class:"form-container mt-4"},ne={class:"form-item_input"},ie={class:"form-group"},le={class:"form-group"},ae={class:"form-item_input"},se={class:"form-group"},de={class:"form-group"},me={class:"form-item_input"},re={class:"form-group"},ue={class:"form-group"},ce={class:"form-item_input"},fe={class:"form-group"},pe={class:"form-group"},ye={class:"form-item_input"},be={class:"form-group"},_e={class:"form-group"},ve={class:"form-item_input"},Ce={class:"form-group"},ge={class:"select-title"},Fe={key:0,class:"lst-user"},De=["onClick","title"],Ve={class:"flex lst-btn gap-8"},$e={class:"form-action"},he={class:"form-action_container"},Ne={class:"form-action_item"},ke={class:"form-action_item"};function Ue(e,o,r,$,h,N){const u=y("ms-input"),d=y("ms-combobox-v2"),b=y("ms-textarea"),c=y("ms-button"),F=y("ms-dynamic-popup");return C(),E(F,{width:900,height:800,title:`${e.editMode?e.$ms.commonFn.getEnumResource(e.editMode,"FormState"):""} ${e.$t("i18nConfigNotify.Title")}`,onBeforeOpen:e.beforeOpen},{content:f(({close:_})=>{var p;return[i("div",oe,[i("div",te,[i("div",ne,[i("div",ie,[s(u,{maxLength:50,rules:[{name:"required"}],label:e.$t("i18nConfigNotify.Detail.config_notify_code"),modelValue:e.model.config_notify_code,"onUpdate:modelValue":o[0]||(o[0]=t=>e.model.config_notify_code=t)},null,8,["label","modelValue"])]),i("div",le,[s(u,{maxLength:250,rules:[{name:"required"}],label:e.$t("i18nConfigNotify.Detail.config_notify_name"),modelValue:e.model.config_notify_name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.model.config_notify_name=t)},null,8,["label","modelValue"])])]),i("div",ae,[i("div",se,[s(u,{maxLength:50,label:e.$t("i18nConfigNotify.Detail.paramerter"),modelValue:e.model.paramerter,"onUpdate:modelValue":o[2]||(o[2]=t=>e.model.paramerter=t)},null,8,["label","modelValue"])]),i("div",de,[s(u,{maxLength:50,label:e.$t("i18nConfigNotify.Detail.sound"),modelValue:e.model.sound,"onUpdate:modelValue":o[3]||(o[3]=t=>e.model.sound=t)},null,8,["label","modelValue"])])]),i("div",me,[i("div",re,[s(d,{label:e.$t("i18nConfigNotify.Detail.channel_name"),valueField:"channel_code",displayField:"channel_name",data:e.dataCombobox.list_channel,buildFilter:e.buildFilterComboboxChannel,initText:e.model.channel_name,onComboboxLoadData:o[4]||(o[4]=t=>e.comboboxLoadData(t,e.dictionaryAPI,e.dataCombobox,"list_channel")),rules:[{name:"forceSelection"},{name:"required"}],queryMode:"remote",remoteFilter:!0,modelValue:e.model.channel_code,"onUpdate:modelValue":o[5]||(o[5]=t=>e.model.channel_code=t),display:e.model.channel_name,"onUpdate:display":o[6]||(o[6]=t=>e.model.channel_name=t)},null,8,["label","data","buildFilter","initText","modelValue","display"])]),i("div",ue,[s(d,{label:e.$t("i18nConfigNotify.Detail.notify_type"),valueField:"dictionary_value",displayField:"dictionary_name",data:e.dataCombobox.notify_type,initText:e.model.notify_type_name,onComboboxLoadData:o[7]||(o[7]=t=>e.comboboxLoadData(t,e.dictionaryAPI,e.dataCombobox,"notify_type")),buildFilter:e.filterType,queryMode:"remote",remoteFilter:!0,modelValue:e.model.notify_type,"onUpdate:modelValue":o[8]||(o[8]=t=>e.model.notify_type=t),display:e.model.notify_type_name,"onUpdate:display":o[9]||(o[9]=t=>e.model.notify_type_name=t)},null,8,["label","data","initText","buildFilter","modelValue","display"])])]),i("div",ce,[i("div",fe,[s(d,{label:e.$t("i18nConfigNotify.Detail.screen_name"),valueField:"dictionary_value",displayField:"dictionary_name",data:e.dataCombobox.screen_code,initText:e.model.screen_name,onComboboxLoadData:o[10]||(o[10]=t=>e.comboboxLoadData(t,e.dictionaryAPI,e.dataCombobox,"screen_code")),buildFilter:e.filterScreen,queryMode:"remote",remoteFilter:!0,modelValue:e.model.screen_code,"onUpdate:modelValue":o[11]||(o[11]=t=>e.model.screen_code=t),display:e.model.screen_name,"onUpdate:display":o[12]||(o[12]=t=>e.model.screen_name=t)},null,8,["label","data","initText","buildFilter","modelValue","display"])]),i("div",pe,[s(d,{label:e.$t("i18nConfigNotify.Detail.function_name"),valueField:"dictionary_value",displayField:"dictionary_name",data:e.dataCombobox.function,initText:e.model.function_name,onComboboxLoadData:o[13]||(o[13]=t=>e.comboboxLoadData(t,e.dictionaryAPI,e.dataCombobox,"function")),buildFilter:e.filterFunction,queryMode:"remote",remoteFilter:!0,modelValue:e.model.function,"onUpdate:modelValue":o[14]||(o[14]=t=>e.model.function=t),display:e.model.function_name,"onUpdate:display":o[15]||(o[15]=t=>e.model.function_name=t)},null,8,["label","data","initText","buildFilter","modelValue","display"])])]),i("div",ye,[i("div",be,[s(b,{maxLength:400,label:e.$t("i18nConfigNotify.Detail.description"),modelValue:e.model.description,"onUpdate:modelValue":o[16]||(o[16]=t=>e.model.description=t)},null,8,["label","modelValue"])]),i("div",_e,[s(b,{maxLength:400,label:e.$t("i18nConfigNotify.Detail.note"),modelValue:e.model.note,"onUpdate:modelValue":o[17]||(o[17]=t=>e.model.note=t)},null,8,["label","modelValue"])])]),i("div",ve,[i("div",Ce,[i("div",null,[i("label",ge,m(e.$t("i18nReceiveNotify.Detail.receiver_ids")),1),(p=e.model.ReceiverDetail)!=null&&p.length?(C(),V("div",Fe,[(C(!0),V(J,null,z(e.model.ReceiverDetail,t=>(C(),V("div",{class:"user-item flex justify-between",key:t.user_id},[i("span",null,m(t.user_name)+" - "+m(t.user_full_name)+" - "+m(t.phone_number),1),i("div",{onClick:S=>e.deleteRow(t),title:e.$t("i18nCommon.delete"),class:"fa-solid fa-xmark color-icon-primary"},null,8,De)]))),128))])):G("",!0),i("div",Ve,[s(c,{onClick:e.openSelectUser},{default:f(()=>[g(m(e.$t("i18nReceiveNotify.Detail.selected_user")),1)]),_:1},8,["onClick"]),s(c,{onClick:e.deleteAllRow,disabled:!e.model.receiver_ids},{default:f(()=>[g(m(e.$t("i18nCommon.crud.delete_all_row")),1)]),_:1},8,["onClick","disabled"])])])])])])],512)]}),footer:f(({close:_})=>[i("div",$e,[i("div",he,[i("div",Ne,[s(c,{onClick:_},{default:f(()=>[g(m(e.$t("i18nCommon.Close")),1)]),_:2},1032,["onClick"])]),i("div",ke,[s(c,{onClick:e.save,class:"primary"},{default:f(()=>[g(m(e.$t("i18nCommon.crud.save")),1)]),_:1},8,["onClick"])])])])]),_:1},8,["title","onBeforeOpen"])}const je=O(ee,[["render",Ue],["__scopeId","data-v-de3ced88"]]);export{je as default};
