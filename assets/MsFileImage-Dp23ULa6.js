import{f as se}from"./fileAPI-_RNgakGO.js";import{m as O,o as C,N as pt,j as U,k,w as et,F as fe,l as me,L as Qt,W as wi,X as yi,be as zi,p as ft,H as Ui,d as Ai,g as Ei,P as qi,r as at,M as Zi,_ as Si,a as ut,b as H,q as Ki,v as oe,t as Le,bi as Gi,c as Qi,bR as Ji,B as tn}from"./index-DmUMvrSQ.js";/*!
 * Viewer.js v1.11.7
 * https://fengyuanchen.github.io/viewerjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-11-24T04:32:19.116Z
 */function en(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ri(n.key),n)}}function nn(t,e,i){return e&&We(t.prototype,e),i&&We(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function sn(t,e,i){return(e=Ri(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ke(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,n)}return i}function Re(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ke(Object(i),!0).forEach(function(n){sn(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ke(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function on(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Ri(t){var e=on(t,"string");return typeof e=="symbol"?e:e+""}function ge(t){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(t)}var Ne={backdrop:!0,button:!0,navbar:!0,title:!0,toolbar:!0,className:"",container:"body",filter:null,fullscreen:!0,inheritedAttributes:["crossOrigin","decoding","isMap","loading","referrerPolicy","sizes","srcset","useMap"],initialCoverage:.9,initialViewIndex:0,inline:!1,interval:5e3,keyboard:!0,focus:!0,loading:!0,loop:!0,minWidth:200,minHeight:100,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,slideOnTouch:!0,toggleOnDblclick:!0,tooltip:!0,transition:!0,zIndex:2015,zIndexInline:0,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,url:"src",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,move:null,moved:null,rotate:null,rotated:null,scale:null,scaled:null,zoom:null,zoomed:null,play:null,stop:null},rn='<div class="viewer-container" tabindex="-1" touch-action="none"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><div class="viewer-toolbar"></div><div class="viewer-navbar"><ul class="viewer-list" role="navigation"></ul></div></div><div class="viewer-tooltip" role="alert" aria-hidden="true"></div><div class="viewer-button" data-viewer-action="mix" role="button"></div><div class="viewer-player"></div></div>',te=typeof window<"u"&&typeof window.document<"u",rt=te?window:{},St=te&&rt.document.documentElement?"ontouchstart"in rt.document.documentElement:!1,xe=te?"PointerEvent"in rt:!1,z="viewer",qt="move",xi="switch",Ot="zoom",Ft="".concat(z,"-active"),an="".concat(z,"-close"),Zt="".concat(z,"-fade"),pe="".concat(z,"-fixed"),hn="".concat(z,"-fullscreen"),Pe="".concat(z,"-fullscreen-exit"),dt="".concat(z,"-hide"),ln="".concat(z,"-hide-md-down"),cn="".concat(z,"-hide-sm-down"),un="".concat(z,"-hide-xs-down"),B="".concat(z,"-in"),Lt="".concat(z,"-invisible"),Rt="".concat(z,"-loading"),dn="".concat(z,"-move"),He="".concat(z,"-open"),bt="".concat(z,"-show"),L="".concat(z,"-transition"),xt="click",ve="dblclick",Fe="dragstart",_e="focusin",$e="keydown",Y="load",mt="error",fn=St?"touchend touchcancel":"mouseup",mn=St?"touchmove":"mousemove",gn=St?"touchstart":"mousedown",je=xe?"pointerdown":gn,Ve=xe?"pointermove":mn,Be=xe?"pointerup pointercancel":fn,Ye="resize",Z="transitionend",Xe="wheel",Ue="ready",qe="show",Ze="shown",Ke="hide",Ge="hidden",Qe="view",kt="viewed",Je="move",ti="moved",ei="rotate",ii="rotated",ni="scale",si="scaled",oi="zoom",ri="zoomed",ai="play",hi="stop",Jt="".concat(z,"Action"),Ce=/\s\s*/,_t=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"];function Nt(t){return typeof t=="string"}var pn=Number.isNaN||rt.isNaN;function I(t){return typeof t=="number"&&!pn(t)}function zt(t){return typeof t>"u"}function Ct(t){return ge(t)==="object"&&t!==null}var vn=Object.prototype.hasOwnProperty;function At(t){if(!Ct(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&vn.call(i,"isPrototypeOf")}catch{return!1}}function M(t){return typeof t=="function"}function D(t,e){if(t&&M(e))if(Array.isArray(t)||I(t.length)){var i=t.length,n;for(n=0;n<i&&e.call(t,t[n],n,t)!==!1;n+=1);}else Ct(t)&&Object.keys(t).forEach(function(o){e.call(t,t[o],o,t)});return t}var V=Object.assign||function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Ct(e)&&n.length>0&&n.forEach(function(s){Ct(s)&&Object.keys(s).forEach(function(r){e[r]=s[r]})}),e},bn=/^(?:width|height|left|top|marginLeft|marginTop)$/;function K(t,e){var i=t.style;D(e,function(n,o){bn.test(o)&&I(n)&&(n+="px"),i[o]=n})}function wn(t){return Nt(t)?t.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t}function yt(t,e){return!t||!e?!1:t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function w(t,e){if(!(!t||!e)){if(I(t.length)){D(t,function(n){w(n,e)});return}if(t.classList){t.classList.add(e);return}var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function x(t,e){if(!(!t||!e)){if(I(t.length)){D(t,function(i){x(i,e)});return}if(t.classList){t.classList.remove(e);return}t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,""))}}function Pt(t,e,i){if(e){if(I(t.length)){D(t,function(n){Pt(n,e,i)});return}i?w(t,e):x(t,e)}}var yn=/([a-z\d])([A-Z])/g;function Me(t){return t.replace(yn,"$1-$2").toLowerCase()}function Et(t,e){return Ct(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(Me(e)))}function be(t,e,i){Ct(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(Me(e)),i)}var Ci=function(){var t=!1;if(te){var e=!1,i=function(){},n=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(s){e=s}});rt.addEventListener("test",i,n),rt.removeEventListener("test",i,n)}return t}();function T(t,e,i){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=i;e.trim().split(Ce).forEach(function(s){if(!Ci){var r=t.listeners;r&&r[s]&&r[s][i]&&(o=r[s][i],delete r[s][i],Object.keys(r[s]).length===0&&delete r[s],Object.keys(r).length===0&&delete t.listeners)}t.removeEventListener(s,o,n)})}function y(t,e,i){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=i;e.trim().split(Ce).forEach(function(s){if(n.once&&!Ci){var r=t.listeners,h=r===void 0?{}:r;o=function(){delete h[s][i],t.removeEventListener(s,o,n);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];i.apply(t,c)},h[s]||(h[s]={}),h[s][i]&&t.removeEventListener(s,h[s][i],n),h[s][i]=o,t.listeners=h}t.addEventListener(s,o,n)})}function W(t,e,i,n){var o;return M(Event)&&M(CustomEvent)?o=new CustomEvent(e,Re({bubbles:!0,cancelable:!0,detail:i},n)):(o=document.createEvent("CustomEvent"),o.initCustomEvent(e,!0,!0,i)),t.dispatchEvent(o)}function zn(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}function Kt(t){var e=t.rotate,i=t.scaleX,n=t.scaleY,o=t.translateX,s=t.translateY,r=[];I(o)&&o!==0&&r.push("translateX(".concat(o,"px)")),I(s)&&s!==0&&r.push("translateY(".concat(s,"px)")),I(e)&&e!==0&&r.push("rotate(".concat(e,"deg)")),I(i)&&i!==1&&r.push("scaleX(".concat(i,")")),I(n)&&n!==1&&r.push("scaleY(".concat(n,")"));var h=r.length?r.join(" "):"none";return{WebkitTransform:h,msTransform:h,transform:h}}function An(t){return Nt(t)?decodeURIComponent(t.replace(/^.*\//,"").replace(/[?&#].*$/,"")):""}var re=rt.navigator&&/Version\/\d+(\.\d+)+?\s+Safari/i.test(rt.navigator.userAgent);function Mi(t,e,i){var n=document.createElement("img");if(t.naturalWidth&&!re)return i(t.naturalWidth,t.naturalHeight),n;var o=document.body||document.documentElement;return n.onload=function(){i(n.width,n.height),re||o.removeChild(n)},D(e.inheritedAttributes,function(s){var r=t.getAttribute(s);r!==null&&n.setAttribute(s,r)}),n.src=t.src,re||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n)),n}function $t(t){switch(t){case 2:return un;case 3:return cn;case 4:return ln;default:return""}}function En(t){var e=Re({},t),i=[];return D(t,function(n,o){delete e[o],D(e,function(s){var r=Math.abs(n.startX-s.startX),h=Math.abs(n.startY-s.startY),a=Math.abs(n.endX-s.endX),l=Math.abs(n.endY-s.endY),c=Math.sqrt(r*r+h*h),u=Math.sqrt(a*a+l*l),d=(u-c)/c;i.push(d)})}),i.sort(function(n,o){return Math.abs(n)<Math.abs(o)}),i[0]}function jt(t,e){var i=t.pageX,n=t.pageY,o={endX:i,endY:n};return e?o:Re({timeStamp:Date.now(),startX:i,startY:n},o)}function Sn(t){var e=0,i=0,n=0;return D(t,function(o){var s=o.startX,r=o.startY;e+=s,i+=r,n+=1}),e/=n,i/=n,{pageX:e,pageY:i}}var Rn={render:function(){this.initContainer(),this.initViewer(),this.initList(),this.renderViewer()},initBody:function(){var e=this.element.ownerDocument,i=e.body||e.documentElement;this.body=i,this.scrollbarWidth=window.innerWidth-e.documentElement.clientWidth,this.initialBodyPaddingRight=i.style.paddingRight,this.initialBodyComputedPaddingRight=window.getComputedStyle(i).paddingRight},initContainer:function(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var e=this.options,i=this.parent,n;e.inline&&(n={width:Math.max(i.offsetWidth,e.minWidth),height:Math.max(i.offsetHeight,e.minHeight)},this.parentData=n),(this.fulled||!n)&&(n=this.containerData),this.viewerData=V({},n)},renderViewer:function(){this.options.inline&&!this.fulled&&K(this.viewer,this.viewerData)},initList:function(){var e=this,i=this.element,n=this.options,o=this.list,s=[];o.innerHTML="",D(this.images,function(r,h){var a=r.src,l=r.alt||An(a),c=e.getImageURL(r);if(a||c){var u=document.createElement("li"),d=document.createElement("img");D(n.inheritedAttributes,function(m){var g=r.getAttribute(m);g!==null&&d.setAttribute(m,g)}),n.navbar&&(d.src=a||c),d.alt=l,d.setAttribute("data-original-url",c||a),u.setAttribute("data-index",h),u.setAttribute("data-viewer-action","view"),u.setAttribute("role","button"),n.keyboard&&u.setAttribute("tabindex",0),u.appendChild(d),o.appendChild(u),s.push(u)}}),this.items=s,D(s,function(r){var h=r.firstElementChild,a,l;be(h,"filled",!0),n.loading&&w(r,Rt),y(h,Y,a=function(u){T(h,mt,l),n.loading&&x(r,Rt),e.loadImage(u)},{once:!0}),y(h,mt,l=function(){T(h,Y,a),n.loading&&x(r,Rt)},{once:!0})}),n.transition&&y(i,kt,function(){w(o,L)},{once:!0})},renderList:function(){var e=this.index,i=this.items[e];if(i){var n=i.nextElementSibling,o=parseInt(window.getComputedStyle(n||i).marginLeft,10),s=i.offsetWidth,r=s+o;K(this.list,V({width:r*this.length-o},Kt({translateX:(this.viewerData.width-s)/2-r*e})))}},resetList:function(){var e=this.list;e.innerHTML="",x(e,L),K(e,Kt({translateX:0}))},initImage:function(e){var i=this,n=this.options,o=this.image,s=this.viewerData,r=this.footer.offsetHeight,h=s.width,a=Math.max(s.height-r,r),l=this.imageData||{},c;this.imageInitializing={abort:function(){c.onload=null}},c=Mi(o,n,function(u,d){var m=u/d,g=Math.max(0,Math.min(1,n.initialCoverage)),f=h,p=a;i.imageInitializing=!1,a*m>h?p=h/m:f=a*m,g=I(g)?g:.9,f=Math.min(f*g,u),p=Math.min(p*g,d);var b=(h-f)/2,E=(a-p)/2,A={left:b,top:E,x:b,y:E,width:f,height:p,oldRatio:1,ratio:f/u,aspectRatio:m,naturalWidth:u,naturalHeight:d},F=V({},A);n.rotatable&&(A.rotate=l.rotate||0,F.rotate=0),n.scalable&&(A.scaleX=l.scaleX||1,A.scaleY=l.scaleY||1,F.scaleX=1,F.scaleY=1),i.imageData=A,i.initialImageData=F,e&&e()})},renderImage:function(e){var i=this,n=this.image,o=this.imageData;if(K(n,V({width:o.width,height:o.height,marginLeft:o.x,marginTop:o.y},Kt(o))),e)if((this.viewing||this.moving||this.rotating||this.scaling||this.zooming)&&this.options.transition&&yt(n,L)){var s=function(){i.imageRendering=!1,e()};this.imageRendering={abort:function(){T(n,Z,s)}},y(n,Z,s,{once:!0})}else e()},resetImage:function(){var e=this.image;e&&(this.viewing&&this.viewing.abort(),e.parentNode.removeChild(e),this.image=null,this.title.innerHTML="")}},xn={bind:function(){var e=this.options,i=this.viewer,n=this.canvas,o=this.element.ownerDocument;y(i,xt,this.onClick=this.click.bind(this)),y(i,Fe,this.onDragStart=this.dragstart.bind(this)),y(n,je,this.onPointerDown=this.pointerdown.bind(this)),y(o,Ve,this.onPointerMove=this.pointermove.bind(this)),y(o,Be,this.onPointerUp=this.pointerup.bind(this)),y(o,$e,this.onKeyDown=this.keydown.bind(this)),y(window,Ye,this.onResize=this.resize.bind(this)),e.zoomable&&e.zoomOnWheel&&y(i,Xe,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleOnDblclick&&y(n,ve,this.onDblclick=this.dblclick.bind(this))},unbind:function(){var e=this.options,i=this.viewer,n=this.canvas,o=this.element.ownerDocument;T(i,xt,this.onClick),T(i,Fe,this.onDragStart),T(n,je,this.onPointerDown),T(o,Ve,this.onPointerMove),T(o,Be,this.onPointerUp),T(o,$e,this.onKeyDown),T(window,Ye,this.onResize),e.zoomable&&e.zoomOnWheel&&T(i,Xe,this.onWheel,{passive:!1,capture:!0}),e.toggleOnDblclick&&T(n,ve,this.onDblclick)}},Cn={click:function(e){var i=this.options,n=this.imageData,o=e.target,s=Et(o,Jt);switch(!s&&o.localName==="img"&&o.parentElement.localName==="li"&&(o=o.parentElement,s=Et(o,Jt)),St&&e.isTrusted&&o===this.canvas&&clearTimeout(this.clickCanvasTimeout),s){case"mix":this.played?this.stop():i.inline?this.fulled?this.exit():this.full():this.hide();break;case"hide":this.pointerMoved||this.hide();break;case"view":this.view(Et(o,"index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(i.loop);break;case"play":this.play(i.fullscreen);break;case"next":this.next(i.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-n.scaleX||-1);break;case"flip-vertical":this.scaleY(-n.scaleY||-1);break;default:this.played&&this.stop()}},dblclick:function(e){e.preventDefault(),this.viewed&&e.target===this.image&&(St&&e.isTrusted&&clearTimeout(this.doubleClickImageTimeout),this.toggle(e.isTrusted?e:e.detail&&e.detail.originalEvent))},load:function(){var e=this;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1);var i=this.element,n=this.options,o=this.image,s=this.index,r=this.viewerData;x(o,Lt),n.loading&&x(this.canvas,Rt),o.style.cssText="height:0;"+"margin-left:".concat(r.width/2,"px;")+"margin-top:".concat(r.height/2,"px;")+"max-width:none!important;position:relative;width:0;",this.initImage(function(){Pt(o,dn,n.movable),Pt(o,L,n.transition),e.renderImage(function(){e.viewed=!0,e.viewing=!1,M(n.viewed)&&y(i,kt,n.viewed,{once:!0}),W(i,kt,{originalImage:e.images[s],index:s,image:o},{cancelable:!1})})})},loadImage:function(e){var i=e.target,n=i.parentNode,o=n.offsetWidth||30,s=n.offsetHeight||50,r=!!Et(i,"filled");Mi(i,this.options,function(h,a){var l=h/a,c=o,u=s;s*l>o?r?c=s*l:u=o/l:r?u=o/l:c=s*l,K(i,V({width:c,height:u},Kt({translateX:(o-c)/2,translateY:(s-u)/2})))})},keydown:function(e){var i=this.options;if(i.keyboard){var n=e.keyCode||e.which||e.charCode;switch(n){case 13:this.viewer.contains(e.target)&&this.click(e);break}if(this.fulled)switch(n){case 27:this.played?this.stop():i.inline?this.fulled&&this.exit():this.hide();break;case 32:this.played&&this.stop();break;case 37:this.played&&this.playing?this.playing.prev():this.prev(i.loop);break;case 38:e.preventDefault(),this.zoom(i.zoomRatio,!0);break;case 39:this.played&&this.playing?this.playing.next():this.next(i.loop);break;case 40:e.preventDefault(),this.zoom(-i.zoomRatio,!0);break;case 48:case 49:e.ctrlKey&&(e.preventDefault(),this.toggle());break}}},dragstart:function(e){e.target.localName==="img"&&e.preventDefault()},pointerdown:function(e){var i=this.options,n=this.pointers,o=e.buttons,s=e.button;if(this.pointerMoved=!1,!(!this.viewed||this.showing||this.viewing||this.hiding||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(I(o)&&o!==1||I(s)&&s!==0||e.ctrlKey))){e.preventDefault(),e.changedTouches?D(e.changedTouches,function(h){n[h.identifier]=jt(h)}):n[e.pointerId||0]=jt(e);var r=i.movable?qt:!1;i.zoomOnTouch&&i.zoomable&&Object.keys(n).length>1?r=Ot:i.slideOnTouch&&(e.pointerType==="touch"||e.type==="touchstart")&&this.isSwitchable()&&(r=xi),i.transition&&(r===qt||r===Ot)&&x(this.image,L),this.action=r}},pointermove:function(e){var i=this.pointers,n=this.action;!this.viewed||!n||(e.preventDefault(),e.changedTouches?D(e.changedTouches,function(o){V(i[o.identifier]||{},jt(o,!0))}):V(i[e.pointerId||0]||{},jt(e,!0)),this.change(e))},pointerup:function(e){var i=this,n=this.options,o=this.action,s=this.pointers,r;e.changedTouches?D(e.changedTouches,function(h){r=s[h.identifier],delete s[h.identifier]}):(r=s[e.pointerId||0],delete s[e.pointerId||0]),o&&(e.preventDefault(),n.transition&&(o===qt||o===Ot)&&w(this.image,L),this.action=!1,St&&o!==Ot&&r&&Date.now()-r.timeStamp<500&&(clearTimeout(this.clickCanvasTimeout),clearTimeout(this.doubleClickImageTimeout),n.toggleOnDblclick&&this.viewed&&e.target===this.image?this.imageClicked?(this.imageClicked=!1,this.doubleClickImageTimeout=setTimeout(function(){W(i.image,ve,{originalEvent:e})},50)):(this.imageClicked=!0,this.doubleClickImageTimeout=setTimeout(function(){i.imageClicked=!1},500)):(this.imageClicked=!1,n.backdrop&&n.backdrop!=="static"&&e.target===this.canvas&&(this.clickCanvasTimeout=setTimeout(function(){W(i.canvas,xt,{originalEvent:e})},50)))))},resize:function(){var e=this;if(!(!this.isShown||this.hiding)&&(this.fulled&&(this.close(),this.initBody(),this.open()),this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){e.renderImage()}),this.played)){if(this.options.fullscreen&&this.fulled&&!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)){this.stop();return}D(this.player.getElementsByTagName("img"),function(i){y(i,Y,e.loadImage.bind(e),{once:!0}),W(i,Y)})}},wheel:function(e){var i=this;if(this.viewed&&(e.preventDefault(),!this.wheeling)){this.wheeling=!0,setTimeout(function(){i.wheeling=!1},50);var n=Number(this.options.zoomRatio)||.1,o=1;e.deltaY?o=e.deltaY>0?1:-1:e.wheelDelta?o=-e.wheelDelta/120:e.detail&&(o=e.detail>0?1:-1),this.zoom(-o*n,!0,null,e)}}},Mn={show:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.element,n=this.options;if(n.inline||this.showing||this.isShown||this.showing)return this;if(!this.ready)return this.build(),this.ready&&this.show(e),this;if(M(n.show)&&y(i,qe,n.show,{once:!0}),W(i,qe)===!1||!this.ready)return this;this.hiding&&this.transitioning.abort(),this.showing=!0,this.open();var o=this.viewer;if(x(o,dt),o.setAttribute("role","dialog"),o.setAttribute("aria-labelledby",this.title.id),o.setAttribute("aria-modal",!0),o.removeAttribute("aria-hidden"),n.transition&&!e){var s=this.shown.bind(this);this.transitioning={abort:function(){T(o,Z,s),x(o,B)}},w(o,L),o.initialOffsetWidth=o.offsetWidth,y(o,Z,s,{once:!0}),w(o,B)}else w(o,B),this.shown();return this},hide:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.element,o=this.options;if(o.inline||this.hiding||!(this.isShown||this.showing))return this;if(M(o.hide)&&y(n,Ke,o.hide,{once:!0}),W(n,Ke)===!1)return this;this.showing&&this.transitioning.abort(),this.hiding=!0,this.played?this.stop():this.viewing&&this.viewing.abort();var s=this.viewer,r=this.image,h=function(){x(s,B),e.hidden()};if(o.transition&&!i){var a=function(u){u&&u.target===s&&(T(s,Z,a),e.hidden())},l=function(){yt(s,L)?(y(s,Z,a),x(s,B)):h()};this.transitioning={abort:function(){e.viewed&&yt(r,L)?T(r,Z,l):yt(s,L)&&T(s,Z,a)}},this.viewed&&yt(r,L)?(y(r,Z,l,{once:!0}),this.zoomTo(0,!1,null,null,!0)):l()}else h();return this},view:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.initialViewIndex;if(i=Number(i)||0,this.hiding||this.played||i<0||i>=this.length||this.viewed&&i===this.index)return this;if(!this.isShown)return this.index=i,this.show();this.viewing&&this.viewing.abort();var n=this.element,o=this.options,s=this.title,r=this.canvas,h=this.items[i],a=h.querySelector("img"),l=Et(a,"originalUrl"),c=a.getAttribute("alt"),u=document.createElement("img");if(D(o.inheritedAttributes,function(p){var b=a.getAttribute(p);b!==null&&u.setAttribute(p,b)}),u.src=l,u.alt=c,M(o.view)&&y(n,Qe,o.view,{once:!0}),W(n,Qe,{originalImage:this.images[i],index:i,image:u})===!1||!this.isShown||this.hiding||this.played)return this;var d=this.items[this.index];d&&(x(d,Ft),d.removeAttribute("aria-selected")),w(h,Ft),h.setAttribute("aria-selected",!0),o.focus&&h.focus(),this.image=u,this.viewed=!1,this.index=i,this.imageData={},w(u,Lt),o.loading&&w(r,Rt),r.innerHTML="",r.appendChild(u),this.renderList(),s.innerHTML="";var m=function(){var b=e.imageData,E=Array.isArray(o.title)?o.title[1]:o.title;s.innerHTML=wn(M(E)?E.call(e,u,b):"".concat(c," (").concat(b.naturalWidth," × ").concat(b.naturalHeight,")"))},g,f;return y(n,kt,m,{once:!0}),this.viewing={abort:function(){T(n,kt,m),u.complete?e.imageRendering?e.imageRendering.abort():e.imageInitializing&&e.imageInitializing.abort():(u.src="",T(u,Y,g),e.timeout&&clearTimeout(e.timeout))}},u.complete?this.load():(y(u,Y,g=function(){T(u,mt,f),e.load()},{once:!0}),y(u,mt,f=function(){T(u,Y,g),e.timeout&&(clearTimeout(e.timeout),e.timeout=!1),x(u,Lt),o.loading&&x(e.canvas,Rt)},{once:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){x(u,Lt),e.timeout=!1},1e3)),this},prev:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.index-1;return i<0&&(i=e?this.length-1:0),this.view(i),this},next:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.length-1,n=this.index+1;return n>i&&(n=e?0:i),this.view(n),this},move:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=this.imageData;return this.moveTo(zt(e)?e:n.x+Number(e),zt(i)?i:n.y+Number(i)),this},moveTo:function(e){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=this.element,r=this.options,h=this.imageData;if(e=Number(e),n=Number(n),this.viewed&&!this.played&&r.movable){var a=h.x,l=h.y,c=!1;if(I(e)?c=!0:e=a,I(n)?c=!0:n=l,c){if(M(r.move)&&y(s,Je,r.move,{once:!0}),W(s,Je,{x:e,y:n,oldX:a,oldY:l,originalEvent:o})===!1)return this;h.x=e,h.y=n,h.left=e,h.top=n,this.moving=!0,this.renderImage(function(){i.moving=!1,M(r.moved)&&y(s,ti,r.moved,{once:!0}),W(s,ti,{x:e,y:n,oldX:a,oldY:l,originalEvent:o},{cancelable:!1})})}}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e)),this},rotateTo:function(e){var i=this,n=this.element,o=this.options,s=this.imageData;if(e=Number(e),I(e)&&this.viewed&&!this.played&&o.rotatable){var r=s.rotate;if(M(o.rotate)&&y(n,ei,o.rotate,{once:!0}),W(n,ei,{degree:e,oldDegree:r})===!1)return this;s.rotate=e,this.rotating=!0,this.renderImage(function(){i.rotating=!1,M(o.rotated)&&y(n,ii,o.rotated,{once:!0}),W(n,ii,{degree:e,oldDegree:r},{cancelable:!1})})}return this},scaleX:function(e){return this.scale(e,this.imageData.scaleY),this},scaleY:function(e){return this.scale(this.imageData.scaleX,e),this},scale:function(e){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,o=this.element,s=this.options,r=this.imageData;if(e=Number(e),n=Number(n),this.viewed&&!this.played&&s.scalable){var h=r.scaleX,a=r.scaleY,l=!1;if(I(e)?l=!0:e=h,I(n)?l=!0:n=a,l){if(M(s.scale)&&y(o,ni,s.scale,{once:!0}),W(o,ni,{scaleX:e,scaleY:n,oldScaleX:h,oldScaleY:a})===!1)return this;r.scaleX=e,r.scaleY=n,this.scaling=!0,this.renderImage(function(){i.scaling=!1,M(s.scaled)&&y(o,si,s.scaled,{once:!0}),W(o,si,{scaleX:e,scaleY:n,oldScaleX:h,oldScaleY:a},{cancelable:!1})})}}return this},zoom:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,s=this.imageData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(s.width*e/s.naturalWidth,i,n,o),this},zoomTo:function(e){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=this.element,a=this.options,l=this.pointers,c=this.imageData,u=c.x,d=c.y,m=c.width,g=c.height,f=c.naturalWidth,p=c.naturalHeight;if(e=Math.max(0,e),I(e)&&this.viewed&&!this.played&&(r||a.zoomable)){if(!r){var b=Math.max(.01,a.minZoomRatio),E=Math.min(100,a.maxZoomRatio);e=Math.min(Math.max(e,b),E)}if(s)switch(s.type){case"wheel":a.zoomRatio>=.055&&e>.95&&e<1.05&&(e=1);break;case"pointermove":case"touchmove":case"mousemove":e>.99&&e<1.01&&(e=1);break}var A=f*e,F=p*e,lt=A-m,Q=F-g,ct=c.ratio;if(M(a.zoom)&&y(h,oi,a.zoom,{once:!0}),W(h,oi,{ratio:e,oldRatio:ct,originalEvent:s})===!1)return this;if(this.zooming=!0,s){var It=zn(this.viewer),vt=l&&Object.keys(l).length>0?Sn(l):{pageX:s.pageX,pageY:s.pageY};c.x-=lt*((vt.pageX-It.left-u)/m),c.y-=Q*((vt.pageY-It.top-d)/g)}else At(o)&&I(o.x)&&I(o.y)?(c.x-=lt*((o.x-u)/m),c.y-=Q*((o.y-d)/g)):(c.x-=lt/2,c.y-=Q/2);c.left=c.x,c.top=c.y,c.width=A,c.height=F,c.oldRatio=ct,c.ratio=e,this.renderImage(function(){i.zooming=!1,M(a.zoomed)&&y(h,ri,a.zoomed,{once:!0}),W(h,ri,{ratio:e,oldRatio:ct,originalEvent:s},{cancelable:!1})}),n&&this.tooltip()}return this},play:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.isShown||this.played)return this;var n=this.element,o=this.options;if(M(o.play)&&y(n,ai,o.play,{once:!0}),W(n,ai)===!1)return this;var s=this.player,r=this.loadImage.bind(this),h=[],a=0,l=0;if(this.played=!0,this.onLoadWhenPlay=r,i&&this.requestFullscreen(i),w(s,bt),D(this.items,function(d,m){var g=d.querySelector("img"),f=document.createElement("img");f.src=Et(g,"originalUrl"),f.alt=g.getAttribute("alt"),f.referrerPolicy=g.referrerPolicy,a+=1,w(f,Zt),Pt(f,L,o.transition),yt(d,Ft)&&(w(f,B),l=m),h.push(f),y(f,Y,r,{once:!0}),s.appendChild(f)}),I(o.interval)&&o.interval>0){var c=function(){clearTimeout(e.playing.timeout),x(h[l],B),l-=1,l=l>=0?l:a-1,w(h[l],B),e.playing.timeout=setTimeout(c,o.interval)},u=function(){clearTimeout(e.playing.timeout),x(h[l],B),l+=1,l=l<a?l:0,w(h[l],B),e.playing.timeout=setTimeout(u,o.interval)};a>1&&(this.playing={prev:c,next:u,timeout:setTimeout(u,o.interval)})}return this},stop:function(){var e=this;if(!this.played)return this;var i=this.element,n=this.options;if(M(n.stop)&&y(i,hi,n.stop,{once:!0}),W(i,hi)===!1)return this;var o=this.player;return clearTimeout(this.playing.timeout),this.playing=!1,this.played=!1,D(o.getElementsByTagName("img"),function(s){T(s,Y,e.onLoadWhenPlay)}),x(o,bt),o.innerHTML="",this.exitFullscreen(),this},full:function(){var e=this,i=this.options,n=this.viewer,o=this.image,s=this.list;return!this.isShown||this.played||this.fulled||!i.inline?this:(this.fulled=!0,this.open(),w(this.button,Pe),i.transition&&(x(s,L),this.viewed&&x(o,L)),w(n,pe),n.setAttribute("role","dialog"),n.setAttribute("aria-labelledby",this.title.id),n.setAttribute("aria-modal",!0),n.removeAttribute("style"),K(n,{zIndex:i.zIndex}),i.focus&&this.enforceFocus(),this.initContainer(),this.viewerData=V({},this.containerData),this.renderList(),this.viewed&&this.initImage(function(){e.renderImage(function(){i.transition&&setTimeout(function(){w(o,L),w(s,L)},0)})}),this)},exit:function(){var e=this,i=this.options,n=this.viewer,o=this.image,s=this.list;return!this.isShown||this.played||!this.fulled||!i.inline?this:(this.fulled=!1,this.close(),x(this.button,Pe),i.transition&&(x(s,L),this.viewed&&x(o,L)),i.focus&&this.clearEnforceFocus(),n.removeAttribute("role"),n.removeAttribute("aria-labelledby"),n.removeAttribute("aria-modal"),x(n,pe),K(n,{zIndex:i.zIndexInline}),this.viewerData=V({},this.parentData),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){e.renderImage(function(){i.transition&&setTimeout(function(){w(o,L),w(s,L)},0)})}),this)},tooltip:function(){var e=this,i=this.options,n=this.tooltipBox,o=this.imageData;return!this.viewed||this.played||!i.tooltip?this:(n.textContent="".concat(Math.round(o.ratio*100),"%"),this.tooltipping?clearTimeout(this.tooltipping):i.transition?(this.fading&&W(n,Z),w(n,bt),w(n,Zt),w(n,L),n.removeAttribute("aria-hidden"),n.initialOffsetWidth=n.offsetWidth,w(n,B)):(w(n,bt),n.removeAttribute("aria-hidden")),this.tooltipping=setTimeout(function(){i.transition?(y(n,Z,function(){x(n,bt),x(n,Zt),x(n,L),n.setAttribute("aria-hidden",!0),e.fading=!1},{once:!0}),x(n,B),e.fading=!0):(x(n,bt),n.setAttribute("aria-hidden",!0)),e.tooltipping=!1},1e3),this)},toggle:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.imageData.ratio===1?this.zoomTo(this.imageData.oldRatio,!0,null,e):this.zoomTo(1,!0,null,e),this},reset:function(){return this.viewed&&!this.played&&(this.imageData=V({},this.initialImageData),this.renderImage()),this},update:function(){var e=this,i=this.element,n=this.options,o=this.isImg;if(o&&!i.parentNode)return this.destroy();var s=[];if(D(o?[i]:i.querySelectorAll("img"),function(l){M(n.filter)?n.filter.call(e,l)&&s.push(l):e.getImageURL(l)&&s.push(l)}),!s.length)return this;if(this.images=s,this.length=s.length,this.ready){var r=[];if(D(this.items,function(l,c){var u=l.querySelector("img"),d=s[c];d&&u?(d.src!==u.src||d.alt!==u.alt)&&r.push(c):r.push(c)}),K(this.list,{width:"auto"}),this.initList(),this.isShown)if(this.length){if(this.viewed){var h=r.indexOf(this.index);if(h>=0)this.viewed=!1,this.view(Math.max(Math.min(this.index-h,this.length-1),0));else{var a=this.items[this.index];w(a,Ft),a.setAttribute("aria-selected",!0)}}}else this.image=null,this.viewed=!1,this.index=0,this.imageData={},this.canvas.innerHTML="",this.title.innerHTML=""}else this.build();return this},destroy:function(){var e=this.element,i=this.options;return e[z]?(this.destroyed=!0,this.ready?(this.played&&this.stop(),i.inline?(this.fulled&&this.exit(),this.unbind()):this.isShown?(this.viewing&&(this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort()),this.hiding&&this.transitioning.abort(),this.hidden()):this.showing&&(this.transitioning.abort(),this.hidden()),this.ready=!1,this.viewer.parentNode.removeChild(this.viewer)):i.inline&&(this.delaying?this.delaying.abort():this.initializing&&this.initializing.abort()),i.inline||T(e,xt,this.onStart),e[z]=void 0,this):this}},Tn={getImageURL:function(e){var i=this.options.url;return Nt(i)?i=e.getAttribute(i):M(i)?i=i.call(this,e):i="",i},enforceFocus:function(){var e=this;this.clearEnforceFocus(),y(document,_e,this.onFocusin=function(i){var n=e.viewer,o=i.target;if(!(o===document||o===n||n.contains(o))){for(;o;){if(o.getAttribute("tabindex")!==null||o.getAttribute("aria-modal")==="true")return;o=o.parentElement}n.focus()}})},clearEnforceFocus:function(){this.onFocusin&&(T(document,_e,this.onFocusin),this.onFocusin=null)},open:function(){var e=this.body;w(e,He),this.scrollbarWidth>0&&(e.style.paddingRight="".concat(this.scrollbarWidth+(parseFloat(this.initialBodyComputedPaddingRight)||0),"px"))},close:function(){var e=this.body;x(e,He),this.scrollbarWidth>0&&(e.style.paddingRight=this.initialBodyPaddingRight)},shown:function(){var e=this.element,i=this.options,n=this.viewer;this.fulled=!0,this.isShown=!0,this.render(),this.bind(),this.showing=!1,i.focus&&(n.focus(),this.enforceFocus()),M(i.shown)&&y(e,Ze,i.shown,{once:!0}),W(e,Ze)!==!1&&this.ready&&this.isShown&&!this.hiding&&this.view(this.index)},hidden:function(){var e=this.element,i=this.options,n=this.viewer;i.fucus&&this.clearEnforceFocus(),this.close(),this.unbind(),w(n,dt),n.removeAttribute("role"),n.removeAttribute("aria-labelledby"),n.removeAttribute("aria-modal"),n.setAttribute("aria-hidden",!0),this.resetList(),this.resetImage(),this.fulled=!1,this.viewed=!1,this.isShown=!1,this.hiding=!1,this.destroyed||(M(i.hidden)&&y(e,Ge,i.hidden,{once:!0}),W(e,Ge,null,{cancelable:!1}))},requestFullscreen:function(e){var i=this.element.ownerDocument;if(this.fulled&&!(i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement)){var n=i.documentElement;n.requestFullscreen?At(e)?n.requestFullscreen(e):n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()}},exitFullscreen:function(){var e=this.element.ownerDocument;this.fulled&&(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())},change:function(e){var i=this.options,n=this.pointers,o=n[Object.keys(n)[0]];if(o){var s=o.endX-o.startX,r=o.endY-o.startY;switch(this.action){case qt:(s!==0||r!==0)&&(this.pointerMoved=!0,this.move(s,r,e));break;case Ot:this.zoom(En(n),!1,null,e);break;case xi:{this.action="switched";var h=Math.abs(s);h>1&&h>Math.abs(r)&&(this.pointers={},s>1?this.prev(i.loop):s<-1&&this.next(i.loop));break}}D(n,function(a){a.startX=a.endX,a.startY=a.endY})}},isSwitchable:function(){var e=this.imageData,i=this.viewerData;return this.length>1&&e.x>=0&&e.y>=0&&e.width<=i.width&&e.height<=i.height}},Dn=rt.Viewer,In=function(t){return function(){return t+=1,t}}(-1),Ti=function(){function t(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(en(this,t),!e||e.nodeType!==1)throw new Error("The first argument is required and must be an element.");this.element=e,this.options=V({},Ne,At(i)&&i),this.action=!1,this.fading=!1,this.fulled=!1,this.hiding=!1,this.imageClicked=!1,this.imageData={},this.index=this.options.initialViewIndex,this.isImg=!1,this.isShown=!1,this.length=0,this.moving=!1,this.played=!1,this.playing=!1,this.pointers={},this.ready=!1,this.rotating=!1,this.scaling=!1,this.showing=!1,this.timeout=!1,this.tooltipping=!1,this.viewed=!1,this.viewing=!1,this.wheeling=!1,this.zooming=!1,this.pointerMoved=!1,this.id=In(),this.init()}return nn(t,[{key:"init",value:function(){var i=this,n=this.element,o=this.options;if(!n[z]){n[z]=this,o.focus&&!o.keyboard&&(o.focus=!1);var s=n.localName==="img",r=[];if(D(s?[n]:n.querySelectorAll("img"),function(l){M(o.filter)?o.filter.call(i,l)&&r.push(l):i.getImageURL(l)&&r.push(l)}),this.isImg=s,this.length=r.length,this.images=r,this.initBody(),zt(document.createElement(z).style.transition)&&(o.transition=!1),o.inline){var h=0,a=function(){if(h+=1,h===i.length){var c;i.initializing=!1,i.delaying={abort:function(){clearTimeout(c)}},c=setTimeout(function(){i.delaying=!1,i.build()},0)}};this.initializing={abort:function(){D(r,function(c){c.complete||(T(c,Y,a),T(c,mt,a))})}},D(r,function(l){if(l.complete)a();else{var c,u;y(l,Y,c=function(){T(l,mt,u),a()},{once:!0}),y(l,mt,u=function(){T(l,Y,c),a()},{once:!0})}})}else y(n,xt,this.onStart=function(l){var c=l.target;c.localName==="img"&&(!M(o.filter)||o.filter.call(i,c))&&i.view(i.images.indexOf(c))})}}},{key:"build",value:function(){if(!this.ready){var i=this.element,n=this.options,o=i.parentNode,s=document.createElement("div");s.innerHTML=rn;var r=s.querySelector(".".concat(z,"-container")),h=r.querySelector(".".concat(z,"-title")),a=r.querySelector(".".concat(z,"-toolbar")),l=r.querySelector(".".concat(z,"-navbar")),c=r.querySelector(".".concat(z,"-button")),u=r.querySelector(".".concat(z,"-canvas"));if(this.parent=o,this.viewer=r,this.title=h,this.toolbar=a,this.navbar=l,this.button=c,this.canvas=u,this.footer=r.querySelector(".".concat(z,"-footer")),this.tooltipBox=r.querySelector(".".concat(z,"-tooltip")),this.player=r.querySelector(".".concat(z,"-player")),this.list=r.querySelector(".".concat(z,"-list")),r.id="".concat(z).concat(this.id),h.id="".concat(z,"Title").concat(this.id),w(h,n.title?$t(Array.isArray(n.title)?n.title[0]:n.title):dt),w(l,n.navbar?$t(n.navbar):dt),Pt(c,dt,!n.button),n.keyboard&&c.setAttribute("tabindex",0),n.backdrop&&(w(r,"".concat(z,"-backdrop")),!n.inline&&n.backdrop!=="static"&&be(u,Jt,"hide")),Nt(n.className)&&n.className&&n.className.split(Ce).forEach(function(A){w(r,A)}),n.toolbar){var d=document.createElement("ul"),m=At(n.toolbar),g=_t.slice(0,3),f=_t.slice(7,9),p=_t.slice(9);m||w(a,$t(n.toolbar)),D(m?n.toolbar:_t,function(A,F){var lt=m&&At(A),Q=m?Me(F):A,ct=lt&&!zt(A.show)?A.show:A;if(!(!ct||!n.zoomable&&g.indexOf(Q)!==-1||!n.rotatable&&f.indexOf(Q)!==-1||!n.scalable&&p.indexOf(Q)!==-1)){var It=lt&&!zt(A.size)?A.size:A,vt=lt&&!zt(A.click)?A.click:A,nt=document.createElement("li");n.keyboard&&nt.setAttribute("tabindex",0),nt.setAttribute("role","button"),w(nt,"".concat(z,"-").concat(Q)),M(vt)||be(nt,Jt,Q),I(ct)&&w(nt,$t(ct)),["small","large"].indexOf(It)!==-1?w(nt,"".concat(z,"-").concat(It)):Q==="play"&&w(nt,"".concat(z,"-large")),M(vt)&&y(nt,xt,vt),d.appendChild(nt)}}),a.appendChild(d)}else w(a,dt);if(!n.rotatable){var b=a.querySelectorAll('li[class*="rotate"]');w(b,Lt),D(b,function(A){a.appendChild(A)})}if(n.inline)w(c,hn),K(r,{zIndex:n.zIndexInline}),window.getComputedStyle(o).position==="static"&&K(o,{position:"relative"}),o.insertBefore(r,i.nextSibling);else{w(c,an),w(r,pe),w(r,Zt),w(r,dt),K(r,{zIndex:n.zIndex});var E=n.container;Nt(E)&&(E=i.ownerDocument.querySelector(E)),E||(E=this.body),E.appendChild(r)}if(n.inline&&(this.render(),this.bind(),this.isShown=!0),this.ready=!0,M(n.ready)&&y(i,Ue,n.ready,{once:!0}),W(i,Ue)===!1){this.ready=!1;return}this.ready&&n.inline&&this.view(this.index)}}}],[{key:"noConflict",value:function(){return window.Viewer=Dn,t}},{key:"setDefaults",value:function(i){V(Ne,At(i)&&i)}}])}();V(Ti.prototype,Rn,xn,Cn,Mn,Tn);function li(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,n)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?li(Object(i),!0).forEach(function(n){X(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):li(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function X(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function On(t,e){if(t==null)return{};var i,n,o=function(r,h){if(r==null)return{};var a,l,c={},u=Object.keys(r);for(l=0;l<u.length;l++)a=u[l],h.indexOf(a)>=0||(c[a]=r[a]);return c}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function gt(t){return function(e){if(Array.isArray(e))return ae(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||function(e,i){if(e){if(typeof e=="string")return ae(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,i)}}(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ae(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ci,Ln,Vt,N=(ci=function(t){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function i(){for(var n=[],o=0;o<arguments.length;o++){var s=arguments[o];if(s){var r=typeof s;if(r==="string"||r==="number")n.push(s);else if(Array.isArray(s)){if(s.length){var h=i.apply(null,s);h&&n.push(h)}}else if(r==="object")if(s.toString===Object.prototype.toString)for(var a in s)e.call(s,a)&&s[a]&&n.push(a);else n.push(s.toString())}}return n.join(" ")}t.exports?(i.default=i,t.exports=i):window.classNames=i})()},ci(Vt={path:Ln,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&Vt.path)}},Vt.exports),Vt.exports),G=function(t){return function(e,i){if(!e)return t;var n;typeof e=="string"?n=e:i=e;var o=t;return n&&(o+="__"+n),o+(i?Object.keys(i).reduce(function(s,r){var h=i[r];return h&&(s+=" "+(typeof h=="boolean"?o+"--"+r:o+"--"+r+"_"+h)),s},""):"")}};function we(t,e,i){var n,o,s,r,h;function a(){var c=Date.now()-r;c<e&&c>=0?n=setTimeout(a,e-c):(n=null,i||(h=t.apply(s,o),s=o=null))}e==null&&(e=100);var l=function(){s=this,o=arguments,r=Date.now();var c=i&&!n;return n||(n=setTimeout(a,e)),c&&(h=t.apply(s,o),s=o=null),h};return l.clear=function(){n&&(clearTimeout(n),n=null)},l.flush=function(){n&&(h=t.apply(s,o),s=o=null,clearTimeout(n),n=null)},l}we.debounce=we;var ye=we,v=function(){return v=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},v.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Di(t,e){var i,n;return t&&e?(i=""+t+e[0].toUpperCase()+e.slice(1),n=t+"-"+e):(i=t||e,n=t||e),{name:i,classname:n}}function Ii(t){return/^blob:/.test(t)}function ui(t){return Ii(t)||function(e){return/^data:/.test(e)}(t)}function wt(t){return!!(t&&t.constructor&&t.call&&t.apply)}function P(t){return t===void 0}function Gt(t){return typeof t=="object"&&t!==null}function ze(t,e,i){var n={};return Gt(t)?(Object.keys(e).forEach(function(o){P(t[o])?n[o]=e[o]:Gt(e[o])?Gt(t[o])?n[o]=ze(t[o],e[o],i[o]):n[o]=t[o]?e[o]:i[o]:e[o]===!0||e[o]===!1?n[o]=!!t[o]:n[o]=t[o]}),n):t?e:i}function Bt(t){var e=Number(t);return Number.isNaN(e)?t:e}function di(t){return typeof(t=="number"||function(e){return typeof e=="object"&&e!==null}(t)&&toString.call(t)=="[object Number]")&&!Oi(t)}function Oi(t){return t!=t}function Li(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}var Wt=function(t,e){t===void 0&&(t={}),e===void 0&&(e={}),this.type="manipulateImage",this.move=t,this.scale=e},Wn=function(t,e){e===void 0&&(e={}),this.type="resize",this.directions=t,this.params=e},Te=function(t){this.type="move",this.directions=t},kn=function(){function t(e,i,n,o,s){this.type="drag",this.nativeEvent=e,this.position=n,this.previousPosition=o,this.element=i,this.anchor=s}return t.prototype.shift=function(){var e=this,i=e.element,n=e.anchor,o=e.position;if(i){var s=i.getBoundingClientRect(),r=s.left,h=s.top;return{left:o.left-r-n.left,top:o.top-h-n.top}}return{left:0,top:0}},t}(),De={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(t){t.cancelable&&!this.disabled&&t.touches.length===1&&(this.touches=gt(t.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),t.touches.length&&this.initAnchor(this.touches.reduce(function(e,i){return{clientX:e.clientX+i.clientX/t.touches.length,clientY:e.clientY+i.clientY/t.touches.length}},{clientX:0,clientY:0})),t.preventDefault&&t.preventDefault(),t.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(t){this.touches.length&&(this.processMove(t,t.touches),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())},onMouseDown:function(t){if(!this.disabled){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.draggable.getBoundingClientRect(),i=e.left,n=e.right,o=e.bottom,s=e.top;this.anchor={left:t.clientX-i,top:t.clientY-s,bottom:o-t.clientY,right:n-t.clientX}},processMove:function(t,e){var i=gt(e);if(this.touches.length){if(this.touches.length===1&&i.length===1){var n=this.$refs.draggable;this.$emit("drag",new kn(t,n,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};De.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"draggable",class:i.classname,onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)}),onMouseover:e[3]||(e[3]=function(){return s.onMouseOver&&s.onMouseOver.apply(s,arguments)}),onMouseleave:e[4]||(e[4]=function(){return s.onMouseLeave&&s.onMouseLeave.apply(s,arguments)})},[pt(t.$slots,"default")],34)};var he=G("vue-handler-wrapper"),Wi={name:"HandlerWrapper",components:{DraggableElement:De},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var t;if(this.horizontalPosition||this.verticalPosition){var e,i=Di(this.horizontalPosition,this.verticalPosition);t=he((X(e={},i.classname,!0),X(e,"disabled",this.disabled),e))}else t=he({disabled:this.disabled});return{root:t,draggable:he("draggable")}}},emits:["leave","enter","drag","drag-end"]};Wi.render=function(t,e,i,n,o,s){var r=U("DraggableElement");return C(),O("div",{class:s.classes.root},[k(r,{class:s.classes.draggable,onDrag:e[1]||(e[1]=function(h){return t.$emit("drag",h)}),onDragEnd:e[2]||(e[2]=function(h){return t.$emit("drag-end")}),onLeave:e[3]||(e[3]=function(h){return t.$emit("leave")}),onEnter:e[4]||(e[4]=function(h){return t.$emit("enter")})},{default:et(function(){return[pt(t.$slots,"default")]}),_:3},8,["class"])],2)};var Nn=G("vue-line-wrapper"),ki={name:"LineWrapper",components:{DraggableElement:De},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var t;return Nn((X(t={},this.position,!0),X(t,"disabled",this.disabled),t))}},emits:["leave","enter","drag","drag-end"]};ki.render=function(t,e,i,n,o,s){var r=U("DraggableElement");return C(),O(r,{class:s.classname,onDrag:e[1]||(e[1]=function(h){return t.$emit("drag",h)}),onDragEnd:e[2]||(e[2]=function(h){return t.$emit("drag-end")}),onLeave:e[3]||(e[3]=function(h){return t.$emit("leave")}),onEnter:e[4]||(e[4]=function(h){return t.$emit("enter")})},{default:et(function(){return[pt(t.$slots,"default")]}),_:3},8,["class"])};var tt=["left","right","top","bottom"],Pn=["left","right"],Hn=["top","bottom"],Fn=["left","top"],_n=["fill-area","fit-area","stencil","none"],fi={left:0,top:0,width:0,height:0};function mi(t,e,i){return!(i=i||["width","height","left","top"]).some(function(n){return t[n]!==e[n]})}function it(t){return{left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height}}function Mt(t,e){return{left:t.left-e.left,top:t.top-e.top}}function _(t){return{left:t.left+t.width/2,top:t.top+t.height/2}}function Ht(t,e){var i={left:0,top:0,right:0,bottom:0};return tt.forEach(function(n){var o=e[n],s=it(t)[n];i[n]=o!==void 0&&s!==void 0?n==="left"||n==="top"?Math.max(0,o-s):Math.max(0,s-o):0}),i}function J(t,e){return{left:t.left-e.left,top:t.top-e.top,width:t.width+e.left+e.right,height:t.height+e.top+e.bottom}}function ee(t){return{left:-t.left,top:-t.top}}function j(t,e){return v(v({},t),{left:t.left+e.left,top:t.top+e.top})}function q(t,e,i,n){if(e!==1){if(i){var o=_(t);return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2+(i.left-o.left)*(1-e),top:t.top+t.height*(1-e)/2+(i.top-o.top)*(1-e)}}return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2,top:t.top+t.height*(1-e)/2}}return t}function R(t){return t.width/t.height}function Tt(t,e){return Math.min(e.right!==void 0&&e.left!==void 0?(e.right-e.left)/t.width:1/0,e.bottom!==void 0&&e.top!==void 0?(e.bottom-e.top)/t.height:1/0)}function Dt(t,e){var i={left:0,top:0},n=Ht(t,e);return n.left&&n.left>0?i.left=n.left:n.right&&n.right>0&&(i.left=-n.right),n.top&&n.top>0?i.top=n.top:n.bottom&&n.bottom>0&&(i.top=-n.bottom),i}function le(t,e){var i;return e.minimum&&t<e.minimum?i=e.minimum:e.maximum&&t>e.maximum&&(i=e.maximum),i}function Ni(t,e){var i=R(t),n=R(e);return e.width<1/0&&e.height<1/0?i>n?{width:e.width,height:e.width/i}:{width:e.height*i,height:e.height}:e.width<1/0?{width:e.width,height:e.width/i}:e.height<1/0?{width:e.height*i,height:e.height}:t}function Pi(t,e){var i=e*Math.PI/180;return{width:Math.abs(t.width*Math.cos(i))+Math.abs(t.height*Math.sin(i)),height:Math.abs(t.width*Math.sin(i))+Math.abs(t.height*Math.cos(i))}}function ht(t,e){var i=e*Math.PI/180;return{left:t.left*Math.cos(i)-t.top*Math.sin(i),top:t.left*Math.sin(i)+t.top*Math.cos(i)}}function ie(t,e){var i=Ht($(t,e),e);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((t.width+i.left+i.right)/t.width,Tt(t,e)):Math.min((t.height+i.top+i.bottom)/t.height,Tt(t,e)):1}function $(t,e,i){i===void 0&&(i=!1);var n=Dt(t,e);return j(t,i?ee(n):n)}function Ae(t){return{width:t.right!==void 0&&t.left!==void 0?t.right-t.left:1/0,height:t.bottom!==void 0&&t.top!==void 0?t.bottom-t.top:1/0}}function $n(t,e){return v(v({},t),{minWidth:Math.min(e.width,t.minWidth),minHeight:Math.min(e.height,t.minHeight),maxWidth:Math.min(e.width,t.maxWidth),maxHeight:Math.min(e.height,t.maxHeight)})}function Hi(t,e,i){i===void 0&&(i=!0);var n={};return tt.forEach(function(o){var s=t[o],r=e[o];s!==void 0&&r!==void 0?n[o]=o==="left"||o==="top"?i?Math.max(s,r):Math.min(s,r):i?Math.min(s,r):Math.max(s,r):r!==void 0?n[o]=r:s!==void 0&&(n[o]=s)}),n}function ne(t,e){return Hi(t,e,!0)}function gi(t){var e=t.size,i=t.aspectRatio,n=t.ignoreMinimum,o=t.sizeRestrictions;return!!((e.correctRatio||R(e)>=i.minimum&&R(e)<=i.maximum)&&e.height<=o.maxHeight&&e.width<=o.maxWidth&&e.width&&e.height&&(n||e.height>=o.minHeight&&e.width>=o.minWidth))}function pi(t,e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)}function ot(t){var e=t.width,i=t.height,n=t.sizeRestrictions,o={minimum:t.aspectRatio&&t.aspectRatio.minimum||0,maximum:t.aspectRatio&&t.aspectRatio.maximum||1/0},s={width:Math.max(n.minWidth,Math.min(n.maxWidth,e)),height:Math.max(n.minHeight,Math.min(n.maxHeight,i))};function r(l,c){return c===void 0&&(c=!1),l.reduce(function(u,d){return gi({size:d,aspectRatio:o,sizeRestrictions:n,ignoreMinimum:c})&&(!u||pi(d,{width:e,height:i})<pi(u,{width:e,height:i}))?d:u},null)}var h=[];o&&[o.minimum,o.maximum].forEach(function(l){l&&h.push({width:s.width,height:s.width/l,correctRatio:!0},{width:s.height*l,height:s.height,correctRatio:!0})}),gi({size:s,aspectRatio:o,sizeRestrictions:n})&&h.push(s);var a=r(h)||r(h,!0);return a&&{width:a.width,height:a.height}}function Ee(t){var e=t.event,i=t.coordinates,n=t.positionRestrictions,o=n===void 0?{}:n,s=j(i,e.directions);return j(s,Dt(s,o))}function jn(t){var e=t.coordinates,i=t.transform,n=t.imageSize,o=t.sizeRestrictions,s=t.positionRestrictions,r=t.aspectRatio,h=t.visibleArea,a=function(c,u){return Ee({coordinates:c,positionRestrictions:s,event:new Te({left:u.left-c.left,top:u.top-c.top})})},l=v({},e);return(Array.isArray(i)?i:[i]).forEach(function(c){var u={};P((u=typeof c=="function"?c({coordinates:l,imageSize:n,visibleArea:h}):c).width)&&P(u.height)||(l=function(d,m){var g=v(v(v({},d),ot({width:m.width,height:m.height,sizeRestrictions:o,aspectRatio:r})),{left:0,top:0});return a(g,{left:d.left,top:d.top})}(l,v(v({},l),u))),P(u.left)&&P(u.top)||(l=a(l,v(v({},l),u)))}),l}function Vn(t){t.event;var e=t.getAreaRestrictions,i=t.boundaries,n=t.coordinates,o=t.visibleArea;t.aspectRatio;var s=t.stencilSize,r=t.sizeRestrictions,h=t.positionRestrictions;t.stencilReference;var a,l,c,u=v({},n),d=v({},o),m=v({},s);a=R(m),l=R(u),c===void 0&&(c=.001),(a===0||l===0?Math.abs(l-a)<c:Math.abs(l/a)<1+c&&Math.abs(l/a)>1-c)||(u=v(v({},u),ot({sizeRestrictions:r,width:u.width,height:u.height,aspectRatio:{minimum:R(m),maximum:R(m)}})));var g=ie(d=q(d,u.width*i.width/(d.width*m.width)),e({visibleArea:d,type:"resize"}));return g!==1&&(d=q(d,g),u=q(u,g)),d=$(d=j(d,Mt(_(u),_(d))),e({visibleArea:d,type:"move"})),{coordinates:u=$(u,ne(it(d),h)),visibleArea:d}}function Bn(t){var e=t.event,i=t.getAreaRestrictions,n=t.boundaries,o=t.coordinates,s=t.visibleArea;t.aspectRatio,t.stencilSize,t.sizeRestrictions;var r=t.positionRestrictions;t.stencilReference;var h=v({},o),a=v({},s);if(o&&s&&e.type!=="manipulateImage"){var l={width:0,height:0};a.width,n.width,R(n)>R(h)?(l.height=.8*n.height,l.width=l.height*R(h)):(l.width=.8*n.width,l.height=l.width*R(h));var c=ie(a=q(a,h.width*n.width/(a.width*l.width)),i({visibleArea:a,type:"resize"}));a=q(a,c),c!==1&&(l.height/=c,l.width/=c),a=$(a=j(a,Mt(_(h),_(a))),i({visibleArea:a,type:"move"})),h=$(h,ne(it(a),r))}return{coordinates:h,visibleArea:a}}function Yn(t){var e=t.event,i=t.coordinates,n=t.visibleArea,o=t.getAreaRestrictions,s=v({},n),r=v({},i);if(e.type==="setCoordinates"){var h=Math.max(0,r.width-s.width),a=Math.max(0,r.height-s.height);h>a?s=q(s,Math.min(r.width/s.width,Tt(s,o({visibleArea:s,type:"resize"})))):a>h&&(s=q(s,Math.min(r.height/s.height,Tt(s,o({visibleArea:s,type:"resize"}))))),s=$(s=j(s,ee(Dt(r,it(s)))),o({visibleArea:s,type:"move"}))}return{visibleArea:s,coordinates:r}}function Xn(t){var e=t.imageSize,i=t.visibleArea,n=t.coordinates,o=i||e;return{left:(i?i.left:0)+o.width/2-n.width/2,top:(i?i.top:0)+o.height/2-n.height/2}}function Un(t){var e=t.imageSize,i=t.visibleArea,n=t.aspectRatio,o=t.sizeRestrictions,s=i||e,r=Math.min(n.maximum||1/0,Math.max(n.minimum||0,R(s))),h=s.width<s.height?{width:.8*s.width,height:.8*s.width/r}:{height:.8*s.height,width:.8*s.height*r};return ot(v(v({},h),{aspectRatio:n,sizeRestrictions:o}))}function qn(t){var e,i,n=t.imageSize,o=t.visibleArea,s=t.boundaries,r=t.aspectRatio,h=t.sizeRestrictions,a=t.stencilSize,l=o||n;return R(l)>R(s)?i=(e=a.height*l.height/s.height)*R(a):e=(i=a.width*l.width/s.width)/R(a),ot({width:i,height:e,aspectRatio:r,sizeRestrictions:h})}function Zn(t){var e=t.getAreaRestrictions,i=t.coordinates,n=t.imageSize,o=R(t.boundaries);if(i){var s={height:Math.max(i.height,n.height),width:Math.max(i.width,n.width)},r=Ni({width:R(s)>o?s.width:s.height*o,height:R(s)>o?s.width/o:s.height},Ae(e())),h={left:i.left+i.width/2-r.width/2,top:i.top+i.height/2-r.height/2,width:r.width,height:r.height},a=Ht(i,it(v({left:0,top:0},n))),l={};return!a.left&&!a.right&&h.width<=n.width&&(l.left=0,l.right=n.width),!a.top&&!a.bottom&&h.height<=n.height&&(l.top=0,l.bottom=n.height),$(h,l)}var c=R(n);return r={height:c>o?n.height:n.width/o,width:c>o?n.height*o:n.width},{left:n.width/2-r.width/2,top:n.height/2-r.height/2,width:r.width,height:r.height}}function Yt(t,e){return Hi(t,it(e))}function Kn(t){var e=t.event,i=t.coordinates,n=t.visibleArea,o=t.sizeRestrictions,s=t.getAreaRestrictions,r=t.positionRestrictions,h=t.adjustStencil,a=e.scale,l=e.move,c=v({},n),u=v({},i),d=1,m=1,g=a.factor&&Math.abs(a.factor-1)>.001;c=j(c,{left:l.left||0,top:l.top||0});var f={stencil:{minimum:Math.max(o.minWidth?o.minWidth/u.width:0,o.minHeight?o.minHeight/u.height:0),maximum:Math.min(o.maxWidth?o.maxWidth/u.width:1/0,o.maxHeight?o.maxHeight/u.height:1/0,Tt(u,r))},area:{maximum:Tt(c,s({visibleArea:c,type:"resize"}))}};a.factor&&g&&(a.factor<1?(m=Math.max(a.factor,f.stencil.minimum))>1&&(m=1):a.factor>1&&(m=Math.min(a.factor,Math.min(f.area.maximum,f.stencil.maximum)))<1&&(m=1)),m&&(c=q(c,m,a.center));var p=i.left-n.left,b=n.width+n.left-(i.width+i.left),E=i.top-n.top,A=n.height+n.top-(i.height+i.top);return c=$(c=j(c,Dt(c,{left:r.left!==void 0?r.left-p*m:void 0,top:r.top!==void 0?r.top-E*m:void 0,bottom:r.bottom!==void 0?r.bottom+A*m:void 0,right:r.right!==void 0?r.right+b*m:void 0})),s({visibleArea:c,type:"move"})),u.width=u.width*m,u.height=u.height*m,u.left=c.left+p*m,u.top=c.top+E*m,u=$(u,ne(it(c),r)),a.factor&&g&&h&&(a.factor>1?d=Math.min(f.area.maximum,a.factor)/m:a.factor<1&&(d=Math.max(u.height/c.height,u.width/c.width,a.factor/m)),d!==1&&(c=j(c=$(c=q(c,d,a.factor>1?a.center:_(u)),s({visibleArea:c,type:"move"})),ee(Dt(u,it(c)))))),{coordinates:u,visibleArea:c}}function Gn(t){var e=t.aspectRatio,i=t.getAreaRestrictions,n=t.coordinates,o=t.visibleArea,s=t.sizeRestrictions,r=t.positionRestrictions,h=t.imageSize,a=t.previousImageSize,l=t.angle,c=v({},n),u=v({},o),d=ht(_(v({left:0,top:0},a)),l);return(c=v(v({},ot({sizeRestrictions:s,aspectRatio:e,width:c.width,height:c.height})),ht(_(c),l))).left-=d.left-h.width/2+c.width/2,c.top-=d.top-h.height/2+c.height/2,u=q(u,ie(u,i({visibleArea:u,type:"resize"}))),{coordinates:c=$(c,r),visibleArea:u=$(u=j(u,Mt(_(c),_(n))),i({visibleArea:u,type:"move"}))}}function Qn(t){var e=t.flip,i=t.previousFlip,n=t.rotate,o=t.getAreaRestrictions,s=t.coordinates,r=t.visibleArea,h=t.imageSize,a=v({},s),l=v({},r),c=i.horizontal!==e.horizontal,u=i.vertical!==e.vertical;if(c||u){var d=ht({left:h.width/2,top:h.height/2},-n),m=ht(_(a),-n),g=ht({left:c?d.left-(m.left-d.left):m.left,top:u?d.top-(m.top-d.top):m.top},n);a=j(a,Mt(g,_(a))),m=ht(_(l),-n),l=$(l=j(l,Mt(g=ht({left:c?d.left-(m.left-d.left):m.left,top:u?d.top-(m.top-d.top):m.top},n),_(l))),o({visibleArea:l,type:"move"}))}return{coordinates:a,visibleArea:l}}function vi(t){var e=t.directions,i=t.coordinates,n=t.positionRestrictions,o=n===void 0?{}:n,s=t.sizeRestrictions,r=t.preserveRatio,h=t.compensate,a=v({},e),l=J(i,a).width,c=J(i,a).height;l<0&&(a.left<0&&a.right<0?(a.left=-(i.width-s.minWidth)/(a.left/a.right),a.right=-(i.width-s.minWidth)/(a.right/a.left)):a.left<0?a.left=-(i.width-s.minWidth):a.right<0&&(a.right=-(i.width-s.minWidth))),c<0&&(a.top<0&&a.bottom<0?(a.top=-(i.height-s.minHeight)/(a.top/a.bottom),a.bottom=-(i.height-s.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(i.height-s.minHeight):a.bottom<0&&(a.bottom=-(i.height-s.minHeight)));var u=Ht(J(i,a),o);h&&(u.left&&u.left>0&&u.right===0?(a.right+=u.left,a.left-=u.left):u.right&&u.right>0&&u.left===0&&(a.left+=u.right,a.right-=u.right),u.top&&u.top>0&&u.bottom===0?(a.bottom+=u.top,a.top-=u.top):u.bottom&&u.bottom>0&&u.top===0&&(a.top+=u.bottom,a.bottom-=u.bottom),u=Ht(J(i,a),o));var d={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(tt.forEach(function(f){var p=u[f];p&&a[f]&&(d[f]=Math.max(0,1-p/a[f]))}),r){var m=Math.min.apply(null,tt.map(function(f){return d[f]}));m!==1/0&&tt.forEach(function(f){a[f]*=m})}else tt.forEach(function(f){d[f]!==1/0&&(a[f]*=d[f])});if(l=J(i,a).width,c=J(i,a).height,a.right+a.left&&(l>s.maxWidth?d.width=(s.maxWidth-i.width)/(a.right+a.left):l<s.minWidth&&(d.width=(s.minWidth-i.width)/(a.right+a.left))),a.bottom+a.top&&(c>s.maxHeight?d.height=(s.maxHeight-i.height)/(a.bottom+a.top):c<s.minHeight&&(d.height=(s.minHeight-i.height)/(a.bottom+a.top))),r){var g=Math.min(d.width,d.height);g!==1/0&&tt.forEach(function(f){a[f]*=g})}else d.width!==1/0&&Pn.forEach(function(f){a[f]*=d.width}),d.height!==1/0&&Hn.forEach(function(f){a[f]*=d.height});return a}function Xt(t,e,i){return e==0&&i==0?t/2:e==0?0:i==0?t:t*Math.abs(e/(e+i))}var Jn=G("vue-simple-handler"),ts=G("vue-simple-handler-wrapper"),Ie={name:"SimpleHandler",components:{HandlerWrapper:Wi},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var t,e=(X(t={},this.horizontalPosition,!!this.horizontalPosition),X(t,this.verticalPosition,!!this.verticalPosition),X(t,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),X(t,"hover",this.hover),t);return{default:N(Jn(e),this.defaultClass,this.hover&&this.hoverClass),wrapper:N(ts(e),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};Ie.render=function(t,e,i,n,o,s){var r=U("HandlerWrapper");return C(),O(r,{class:s.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:s.onDrag,onDragEnd:s.onDragEnd,onEnter:s.onEnter,onLeave:s.onLeave},{default:et(function(){return[k("div",{class:s.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var es=G("vue-simple-line"),is=G("vue-simple-line-wrapper"),Oe={name:"SimpleLine",components:{LineWrapper:ki},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:N(es(X({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:N(is(X({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};Oe.render=function(t,e,i,n,o,s){var r=U("LineWrapper");return C(),O(r,{class:s.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:s.onDrag,onDragEnd:s.onDragEnd,onEnter:s.onEnter,onLeave:s.onLeave},{default:et(function(){return[k("div",{class:s.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var ce=G("vue-bounding-box"),ns=["east","west",null],ss=["south","north",null],Fi={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return Ie}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return Oe}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var t=[];return ns.forEach(function(e){ss.forEach(function(i){if(e!==i){var n=Di(e,i),o=n.name,s=n.classname;t.push({name:o,classname:s,verticalDirection:i,horizontalDirection:e})}})}),{points:t}},computed:{style:function(){var t={};return this.width&&this.height&&(t.width="".concat(this.width,"px"),t.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),t},classes:function(){var t=this.handlersClasses,e=this.handlersWrappersClasses,i=this.linesClasses,n=this.linesWrappersClasses;return{root:ce(),handlers:t,handlersWrappers:e,lines:i,linesWrappers:n}},lineNodes:function(){var t=this,e=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!t.lines[i.name]||e.push({name:i.name,component:t.linesComponent,class:N(t.classes.lines.default,t.classes.lines[i.name],!t.resizable&&t.classes.lines.disabled),wrapperClass:N(t.classes.linesWrappers.default,t.classes.linesWrappers[i.name],!t.resizable&&t.classes.linesWrappers.disabled),hoverClass:t.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!t.resizable})}),e},handlerNodes:function(){var t=this,e=[],i=this.width,n=this.height;return this.points.forEach(function(o){if(t.handlers[o.name]){var s={name:o.name,component:t.handlersComponent,class:N(t.classes.handlers.default,t.classes.handlers[o.name]),wrapperClass:N(t.classes.handlersWrappers.default,t.classes.handlersWrappers[o.name]),hoverClass:t.classes.handlers.hover,verticalDirection:o.verticalDirection,horizontalDirection:o.horizontalDirection,disabled:!t.resizable};if(i&&n){var r=o.horizontalDirection,h=o.verticalDirection,a=r==="east"?i:r==="west"?0:i/2,l=h==="south"?n:h==="north"?0:n/2;s.wrapperClass=ce("handler"),s.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(l,"px)")},t.transitions&&t.transitions.enabled&&(s.wrapperStyle.transition="".concat(t.transitions.time,"ms ").concat(t.transitions.timingFunction))}else s.wrapperClass=ce("handler",X({},o.classname,!0));e.push(s)}}),e}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(t,e,i){var n,o=t.shift(),s=o.left,r=o.top,h={left:0,right:0,top:0,bottom:0};e==="west"?h.left-=s:e==="east"&&(h.right+=s),i==="north"?h.top-=r:i==="south"&&(h.bottom+=r),!i&&e?n="width":i&&!e&&(n="height"),this.resizable&&this.$emit("resize",new Wn(h,{allowedDirections:{left:e==="west"||!e,right:e==="east"||!e,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:t.nativeEvent&&t.nativeEvent.shiftKey,respectDirection:n}))}},emits:["resize","resize-end"]};Fi.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"box",class:s.classes.root,style:s.style},[pt(t.$slots,"default"),k("div",null,[(C(!0),O(fe,null,me(s.lineNodes,function(r){return C(),O(Qt(r.component),{key:r.name,"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,position:r.name,disabled:r.disabled,onDrag:function(h){return s.onHandlerDrag(h,r.horizontalDirection,r.verticalDirection)},onDragEnd:e[1]||(e[1]=function(h){return s.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(C(!0),O(fe,null,me(s.handlerNodes,function(r){return C(),O("div",{key:r.name,style:r.wrapperStyle,class:r.wrapperClass},[(C(),O(Qt(r.component),{"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,"horizontal-position":r.horizontalDirection,"vertical-position":r.verticalDirection,disabled:r.disabled,onDrag:function(h){return s.onHandlerDrag(h,r.horizontalDirection,r.verticalDirection)},onDragEnd:e[2]||(e[2]=function(h){return s.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var os=G("vue-draggable-area"),_i={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:os()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(t){if(t.cancelable){var e=this.movable&&t.touches.length===1;e&&(this.touches=gt(t.touches)),(this.touchStarted||e)&&(t.preventDefault(),t.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(t){this.touches.length>=1&&(this.touchStarted?(this.processMove(t,t.touches),t.preventDefault(),t.stopPropagation()):Li({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:t.touches[0].clientX,y:t.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(t){if(this.movable&&t.button===0){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.cancelable&&t.preventDefault(),t.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.container.getBoundingClientRect(),i=e.left,n=e.top;this.anchor={x:t.clientX-i,y:t.clientY-n}},processMove:function(t,e){var i=gt(e);if(this.touches.length){var n=this.$refs.container.getBoundingClientRect(),o=n.left,s=n.top;this.touches.length===1&&i.length===1&&this.$emit("move",new Te({left:i[0].clientX-(o+this.anchor.x),top:i[0].clientY-(s+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};_i.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"container",onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)})},[pt(t.$slots,"default")],544)};function ue(t){var e,i;return{rotate:t.rotate||0,flip:{horizontal:((e=t==null?void 0:t.flip)===null||e===void 0?void 0:e.horizontal)||!1,vertical:((i=t==null?void 0:t.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function rs(t){return new Promise(function(e,i){try{if(t)if(/^data:/i.test(t))e(function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var l=atob(a),c=l.length,u=new ArrayBuffer(c),d=new Uint8Array(u),m=0;m<c;m++)d[m]=l.charCodeAt(m);return u}(t));else if(/^blob:/i.test(t)){var n=new FileReader;n.onload=function(a){e(a.target.result)},s=t,r=function(a){n.readAsArrayBuffer(a)},(h=new XMLHttpRequest).open("GET",s,!0),h.responseType="blob",h.onload=function(){this.status!=200&&this.status!==0||r(this.response)},h.send()}else{var o=new XMLHttpRequest;o.onreadystatechange=function(){o.readyState===4&&(o.status===200||o.status===0?e(o.response):i("Warning: could not load an image to parse its orientation"),o=null)},o.onprogress=function(){o.getResponseHeader("content-type")!=="image/jpeg"&&o.abort()},o.withCredentials=!1,o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null)}else i("Error: the image is empty")}catch(a){i(a)}var s,r,h})}function $i(t){var e=t.rotate,i=t.flip,n=t.scaleX,o=t.scaleY,s="";return s+=" rotate("+e+"deg) ",s+=" scaleX("+n*(i.horizontal?-1:1)+") ",s+=" scaleY("+o*(i.vertical?-1:1)+") "}function as(t){try{var e,i=new DataView(t),n=void 0,o=void 0,s=void 0,r=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var h=i.byteLength,a=2;a+1<h;){if(i.getUint8(a)===255&&i.getUint8(a+1)===225){s=a;break}a++}if(s&&(n=s+10,function(m,g,f){var p,b="";for(p=g,f+=g;p<f;p++)b+=String.fromCharCode(m.getUint8(p));return b}(i,s+4,4)==="Exif")){var l=i.getUint16(n);if(((o=l===18761)||l===19789)&&i.getUint16(n+2,o)===42){var c=i.getUint32(n+4,o);c>=8&&(r=n+c)}}if(r){for(var u=i.getUint16(r,o),d=0;d<u;d++)if(a=r+12*d+2,i.getUint16(a,o)===274){a+=8,e=i.getUint16(a,o),i.setUint16(a,1,o);break}}return e}catch{return null}}function bi(t,e){var i=e.getBoundingClientRect(),n=i.left,o=i.top,s={left:0,top:0},r=0;return t.forEach(function(h){s.left+=(h.clientX-n)/t.length,s.top+=(h.clientY-o)/t.length}),t.forEach(function(h){r+=Li({x:s.left,y:s.top},{x:h.clientX-n,y:h.clientY-o})}),{centerMass:s,spread:r,count:t.length}}var ji={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=ye(this.processEnd),this.touches=[]},methods:{processMove:function(t,e){if(this.touches.length){if(this.touches.length===1&&e.length===1)this.$emit("move",new Wt({left:this.touches[0].clientX-e[0].clientX,top:this.touches[0].clientY-e[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=bi(e,this.$refs.container),n=this.oldGeometricProperties;n.count===i.count&&n.count>1&&this.$emit("resize",new Wt({left:n.centerMass.left-i.centerMass.left,top:n.centerMass.top-i.centerMass.top},{factor:n.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=e}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(t){return this.eventsFilter?this.eventsFilter(t,this.transforming)!==!1:(t.preventDefault(),t.stopPropagation(),!0)},onTouchStart:function(t){if(t.cancelable&&(this.touchMove||this.touchResize&&t.touches.length>1)&&this.processEvent(t)){var e=this.$refs.container,i=e.getBoundingClientRect(),n=i.left,o=i.top,s=i.bottom,r=i.right;this.touches=gt(t.touches).filter(function(h){return h.clientX>n&&h.clientX<r&&h.clientY>o&&h.clientY<s}),this.oldGeometricProperties=bi(this.touches,e)}},onTouchEnd:function(t){t.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(t){var e=this;if(this.touches.length){var i=gt(t.touches).filter(function(n){return!n.identifier||e.touches.find(function(o){return o.identifier===n.identifier})});this.processEvent(t)&&(this.processMove(t,i),this.processStart())}},onMouseDown:function(t){if(this.mouseMove&&"buttons"in t&&t.buttons===1&&this.processEvent(t)){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.processStart()}},onMouseMove:function(t){this.touches.length&&this.processEvent(t)&&this.processMove(t,[{clientX:t.clientX,clientY:t.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(t){if(this.wheelResize&&this.processEvent(t)){var e=this.$refs.container.getBoundingClientRect(),i=e.left,n=e.top,o=1+this.wheelResize.ratio*(r=t.deltaY||t.detail||t.wheelDelta,(h=+r)==0||Oi(h)?h:h>0?1:-1),s={left:t.clientX-i,top:t.clientY-n};this.$emit("resize",new Wt({},{factor:o,center:s})),this.touches.length||this.debouncedProcessEnd()}var r,h}},emits:["resize","move","transform-end"]};ji.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"container",onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)}),onWheel:e[3]||(e[3]=function(){return s.onWheel&&s.onWheel.apply(s,arguments)})},[pt(t.$slots,"default")],544)};var Se={components:{TransformableImage:ji},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};Se.render=function(t,e,i,n,o,s){var r=U("transformable-image");return C(),O(r,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:e[1]||(e[1]=function(h){return t.$emit("move",h)}),onResize:e[2]||(e[2]=function(h){return t.$emit("resize",h)})},{default:et(function(){return[pt(t.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var Ut=G("vue-preview"),Vi={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:Ut({fill:this.fill}),wrapper:Ut("wrapper"),imageWrapper:Ut("image-wrapper"),image:N(Ut("image"),this.imageClass)}},style:function(){if(this.fill)return{};var t={};return this.width&&(t.width="".concat(this.size.width,"px")),this.height&&(t.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},wrapperStyle:function(){var t={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},imageStyle:function(){if(this.coordinates&&this.image){var t=this.coordinates.width/this.size.width,e=S(S({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/t,scaleY:1/t}),i=this.imageSize.width,n=this.imageSize.height,o=Pi({width:i,height:n},e.rotate),s={width:"".concat(i,"px"),height:"".concat(n,"px"),left:"0px",top:"0px"},r={rotate:{left:(i-o.width)*e.scaleX/2,top:(n-o.height)*e.scaleY/2},scale:{left:(1-e.scaleX)*i/2,top:(1-e.scaleY)*n/2}};return s.transform=`translate(
				`.concat(-this.coordinates.left/t-r.rotate.left-r.scale.left,"px,").concat(-this.coordinates.top/t-r.rotate.top-r.scale.top,"px) ")+$i(e),this.transitions&&this.transitions.enabled&&(s.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),s}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(t){(t.width||t.height)&&this.onChangeImage()}},mounted:function(){var t=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){t.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var t=this.$refs.image;this.calculatedImageSize.height=t.naturalHeight,this.calculatedImageSize.width=t.naturalWidth},refresh:function(){var t=this.$refs.root;this.width||(this.calculatedSize.width=t.clientWidth),this.height||(this.calculatedSize.height=t.clientHeight)},onChangeImage:function(){var t=this.$refs.image;t&&t.complete&&this.refreshImage(),this.refresh()}}};Vi.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"root",class:s.classes.root,style:s.style},[k("div",{ref:"wrapper",class:s.classes.wrapper,style:s.wrapperStyle},[wi(k("img",{ref:"image",src:i.image&&i.image.src,class:s.classes.image,style:s.imageStyle},null,14,["src"]),[[yi,i.image&&i.image.src]])],6)],6)};var Bi={components:{Preview:Vi},inheritAttrs:!1};Bi.render=function(t,e,i,n,o,s){var r=U("preview");return C(),O(r,zi(t.$attrs,{fill:!0}),null,16)};var de=G("vue-rectangle-stencil"),Yi={name:"RectangleStencil",components:{StencilPreview:Bi,BoundingBox:Fi,DraggableArea:_i},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return Ie}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return Oe}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:N(de({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:N(de("preview"),this.previewClass),boundingBox:N(de("bounding-box"),this.boundingBoxClass)}},style:function(){var t=this.stencilCoordinates,e=t.height,i=t.width,n=t.left,o=t.top,s={width:"".concat(i,"px"),height:"".concat(e,"px"),transform:"translate(".concat(n,"px, ").concat(o,"px)")};return this.transitions&&this.transitions.enabled&&(s.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),s}},methods:{onMove:function(t){this.$emit("move",t),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(t){this.$emit("resize",t),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};Yi.render=function(t,e,i,n,o,s){var r=U("stencil-preview"),h=U("draggable-area"),a=U("bounding-box");return C(),O("div",{class:s.classes.stencil,style:s.style},[k(a,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:s.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:s.onResize,onResizeEnd:s.onResizeEnd},{default:et(function(){return[k(h,{movable:i.movable,onMove:s.onMove,onMoveEnd:s.onMoveEnd},{default:et(function(){return[k(r,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:s.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var hs=["transitions"],st=G("vue-advanced-cropper"),Xi={name:"Cropper",components:{BackgroundWrapper:Se},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return Yi}},backgroundWrapperComponent:{type:[Object,String],default:function(){return Se}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(t){return _n.indexOf(t)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(t){return!(typeof t=="string"&&t!=="fill"&&t!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(t){var e=t.event,i=t.coordinates,n=t.aspectRatio,o=t.positionRestrictions,s=t.sizeRestrictions,r=v(v({},i),{right:i.left+i.width,bottom:i.top+i.height}),h=e.params||{},a=v({},e.directions),l=h.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};s.widthFrozen&&(a.left=0,a.right=0),s.heightFrozen&&(a.top=0,a.bottom=0),tt.forEach(function(F){l[F]||(a[F]=0)});var c=J(r,a=vi({coordinates:r,directions:a,sizeRestrictions:s,positionRestrictions:o})).width,u=J(r,a).height,d=h.preserveRatio?R(r):le(c/u,n);if(d){var m=h.respectDirection;if(m||(m=r.width>=r.height||d===1?"width":"height"),m==="width"){var g=c/d-r.height;if(l.top&&l.bottom){var f=a.top,p=a.bottom;a.bottom=Xt(g,p,f),a.top=Xt(g,f,p)}else l.bottom?a.bottom=g:l.top?a.top=g:l.right?a.right=0:l.left&&(a.left=0)}else if(m==="height"){var b=r.width-u*d;if(l.left&&l.right){var E=a.left,A=a.right;a.left=-Xt(b,E,A),a.right=-Xt(b,A,E)}else l.left?a.left=-b:l.right?a.right=-b:l.top?a.top=0:l.bottom&&(a.bottom=0)}a=vi({directions:a,coordinates:r,sizeRestrictions:s,positionRestrictions:o,preserveRatio:!0,compensate:h.compensate})}return c=J(r,a).width,u=J(r,a).height,(d=h.preserveRatio?R(r):le(c/u,n))&&Math.abs(d-c/u)>.001&&tt.forEach(function(F){l[F]||(a[F]=0)}),Ee({event:new Te({left:-a.left,top:-a.top}),coordinates:{width:i.width+a.right+a.left,height:i.height+a.top+a.bottom,left:i.left,top:i.top},positionRestrictions:o})}},moveAlgorithm:{type:Function,default:Ee},initStretcher:{type:Function,default:function(t){var e=t.stretcher,i=t.imageSize,n=R(i);e.style.width=i.width+"px",e.style.height=e.clientWidth/n+"px",e.style.width=e.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(t){var e=t.visibleArea,i=t.coordinates,n=t.aspectRatio,o=t.sizeRestrictions,s=t.positionRestrictions,r=v(v({},i),ot({width:i.width,height:i.height,aspectRatio:n,sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minHeight:Math.min(e.height,o.minHeight),minWidth:Math.min(e.width,o.minWidth)}}));return r=$(r=j(r,Mt(_(i),_(r))),ne(it(e),s))}},fitVisibleArea:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,n=t.getAreaRestrictions,o=t.coordinates,s=v({},e);s.height=s.width/R(i),s.top+=(e.height-s.height)/2,(o.height-s.height>0||o.width-s.width>0)&&(s=q(s,Math.max(o.height/s.height,o.width/s.width)));var r=ee(Dt(o,it(s=q(s,ie(s,n({visibleArea:s,type:"resize"}))))));return s.width<o.width&&(r.left=0),s.height<o.height&&(r.top=0),s=$(s=j(s,r),n({visibleArea:s,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,n=t.imageSize,o=t.imageRestriction,s=t.type,r={};return o==="fill-area"?r={left:0,top:0,right:n.width,bottom:n.height}:o==="fit-area"&&(R(i)>R(n)?(r={top:0,bottom:n.height},e&&s==="move"&&(e.width>n.width?(r.left=-(e.width-n.width)/2,r.right=n.width-r.left):(r.left=0,r.right=n.width))):(r={left:0,right:n.width},e&&s==="move"&&(e.height>n.height?(r.top=-(e.height-n.height)/2,r.bottom=n.height-r.top):(r.top=0,r.bottom=n.height)))),r}},sizeRestrictionsAlgorithm:{type:Function,default:function(t){return{minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.imageSize,i={};return t.imageRestriction!=="none"&&(i={left:0,top:0,right:e.width,bottom:e.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:S({},fi)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var t=function(e){return e*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(t))+Math.abs(this.imageAttributes.height*Math.sin(t)),height:Math.abs(this.imageAttributes.width*Math.sin(t))+Math.abs(this.imageAttributes.height*Math.cos(t))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var t=ze(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:ze(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:t}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var t=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:P(this.minWidth)?0:Bt(this.minWidth),minHeight:P(this.minHeight)?0:Bt(this.minHeight),maxWidth:P(this.maxWidth)?1/0:Bt(this.maxWidth),maxHeight:P(this.maxHeight)?1/0:Bt(this.maxHeight)});if(t=function(n){var o=n.areaRestrictions,s=n.sizeRestrictions,r=n.boundaries,h=n.positionRestrictions,a=v(v({},s),{minWidth:s.minWidth!==void 0?s.minWidth:0,minHeight:s.minHeight!==void 0?s.minHeight:0,maxWidth:s.maxWidth!==void 0?s.maxWidth:1/0,maxHeight:s.maxHeight!==void 0?s.maxHeight:1/0});h.left!==void 0&&h.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,h.right-h.left)),h.bottom!==void 0&&h.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,h.bottom-h.top));var l=Ae(o),c=Ni(r,l);return l.width<1/0&&(!a.maxWidth||a.maxWidth>c.width)&&(a.maxWidth=Math.min(a.maxWidth,c.width)),l.height<1/0&&(!a.maxHeight||a.maxHeight>c.height)&&(a.maxHeight=Math.min(a.maxHeight,c.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a}({sizeRestrictions:t,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var e=this.getStencilSize(),i=Ae(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));t.maxWidth=Math.min(t.maxWidth,i.width*e.width/this.boundaries.width),t.maxHeight=Math.min(t.maxHeight,i.height*e.height/this.boundaries.height),t.maxWidth<t.minWidth&&(t.minWidth=t.maxWidth),t.maxHeight<t.minHeight&&(t.minHeight=t.maxHeight)}return t}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:st(),image:N(st("image"),this.imageClass),stencil:st("stencil"),boundaries:N(st("boundaries"),this.boundariesClass),stretcher:N(st("stretcher")),background:N(st("background"),this.backgroundClass),foreground:N(st("foreground"),this.foregroundClass),imageWrapper:N(st("image-wrapper")),cropperWrapper:N(st("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var t=this.coordinates,e=t.width,i=t.height,n=t.left,o=t.top;return{width:e/this.coefficient,height:i/this.coefficient,left:(n-this.visibleArea.left)/this.coefficient,top:(o-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var t={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(t.opacity="0"),t},imageStyle:function(){var t=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},e={left:(t.width-this.imageSize.width)/(2*this.coefficient),top:(t.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*t.width/2,top:(1-1/this.coefficient)*t.height/2},n=S(S({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/t.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/t.height)}),o={width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-e.left-i.left-this.imageTransforms.translateX,"px, ").concat(-e.top-i.top-this.imageTransforms.translateY,"px)")+$i(n)};return this.transitionsOptions.enabled&&(o.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),o}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var t=this;this.$nextTick(function(){t.resetCoordinates(),t.runAutoZoom("setCoordinates"),t.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(t,e){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return t[i]!==e[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=ye(this.update,this.debounce),this.debouncedDisableTransitions=ye(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var t=this.initialized?this.prepareResult(S({},this.coordinates)):this.defaultCoordinates(),e={rotate:this.imageTransforms.rotate%360,flip:S({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:t,visibleArea:this.visibleArea?S({},this.visibleArea):null,imageTransforms:e,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:t,visibleArea:this.visibleArea?S({},this.visibleArea):null,canvas:void 0,imageTransforms:e}},zoom:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,o=n===void 0||n;this.onManipulateImage(new Wt({},{factor:1/t,center:e}),{normalize:!1,transitions:o})},move:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,o=n===void 0||n;this.onManipulateImage(new Wt({left:t||0,top:e||0}),{normalize:!1,transitions:o})},setCoordinates:function(t){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=i.autoZoom,o=n===void 0||n,s=i.transitions,r=s===void 0||s;this.$nextTick(function(){e.imageLoaded?(e.transitionsActive||(r&&e.enableTransitions(),e.coordinates=e.applyTransform(t),o&&e.runAutoZoom("setCoordinates"),r&&e.debouncedDisableTransitions()),e.onChange()):e.delayedTransforms=t})},refresh:function(){var t=this,e=this.$refs.image;if(this.src&&e)return this.initialized?this.updateVisibleArea().then(function(){t.onChange()}):this.resetVisibleArea().then(function(){t.onChange()})},reset:function(){var t=this;return this.resetVisibleArea().then(function(){t.onChange(!1)})},awaitRender:function(t){var e=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){t(),e.awaiting=!1}))},prepareResult:function(t){return this.roundResult?function(e){var i=e.coordinates,n=e.sizeRestrictions,o=e.positionRestrictions,s={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return s.width>n.maxWidth?s.width=Math.floor(i.width):s.width<n.minWidth&&(s.width=Math.ceil(i.width)),s.height>n.maxHeight?s.height=Math.floor(i.height):s.height<n.minHeight&&(s.height=Math.ceil(i.height)),$(s,o)}(S(S({},this.getPublicProperties()),{},{positionRestrictions:Yt(this.positionRestrictions,this.visibleArea),coordinates:t})):t},processAutoZoom:function(t,e,i,n){var o=this.autoZoomAlgorithm;o||(o=this.stencilSize?Vn:this.autoZoom?Bn:Yn);var s=o({event:{type:t,params:n},visibleArea:e,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return S(S({},s),{},{changed:!mi(s.visibleArea,e)||!mi(s.coordinates,i)})},runAutoZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.transitions,n=i!==void 0&&i,o=On(e,hs),s=this.processAutoZoom(t,this.visibleArea,this.coordinates,o),r=s.visibleArea,h=s.coordinates,a=s.changed;n&&a&&this.enableTransitions(),this.visibleArea=r,this.coordinates=h,n&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(t){return function(e){var i=e.event,n=e.visibleArea,o=e.coefficient;if(i.type==="manipulateImage")return v(v({},i),{move:{left:i.move&&i.move.left?o*i.move.left:0,top:i.move&&i.move.top?o*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*o+n.left,top:i.scale.center.top*o+n.top}:null}});if(i.type==="resize"){var s=v(v({},i),{directions:v({},i.directions)});return tt.forEach(function(h){s.directions[h]*=o}),s}if(i.type==="move"){var r=v(v({},i),{directions:v({},i.directions)});return Fn.forEach(function(h){r.directions[h]*=o}),r}return i}(S(S({},this.getPublicProperties()),{},{event:t}))},getCanvas:function(){if(this.$refs.canvas){var t=this.$refs.canvas,e=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(h,a,l){var c=l.rotate,u=l.flip,d={width:a.naturalWidth,height:a.naturalHeight},m=Pi(d,c),g=h.getContext("2d");h.height=m.height,h.width=m.width,g.save();var f=ht(_(v({left:0,top:0},d)),c);return g.translate(-(f.left-m.width/2),-(f.top-m.height/2)),g.rotate(c*Math.PI/180),g.translate(u.horizontal?d.width:0,u.vertical?d.height:0),g.scale(u.horizontal?-1:1,u.vertical?-1:1),g.drawImage(a,0,0,d.width,d.height),g.restore(),h}(this.$refs.sourceCanvas,e,this.imageTransforms):e,n=S({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),o=function(h){return h.find(function(a){return l=a,!Number.isNaN(parseFloat(l))&&isFinite(l);var l})},s=ot({sizeRestrictions:{minWidth:o([n.width,n.minWidth])||0,minHeight:o([n.height,n.minHeight])||0,maxWidth:o([n.width,n.maxWidth])||1/0,maxHeight:o([n.height,n.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(n.maxArea&&s.width*s.height>n.maxArea){var r=Math.sqrt(n.maxArea/(s.width*s.height));s={width:Math.round(r*s.width),height:Math.round(r*s.height)}}return function(h,a,l,c,u){h.width=c?c.width:l.width,h.height=c?c.height:l.height;var d=h.getContext("2d");d.clearRect(0,0,h.width,h.height),u&&(u.imageSmoothingEnabled&&(d.imageSmoothingEnabled=u.imageSmoothingEnabled),u.imageSmoothingQuality&&(d.imageSmoothingQuality=u.imageSmoothingQuality),u.fillColor&&(d.fillStyle=u.fillColor,d.fillRect(0,0,h.width,h.height),d.save()));var m=l.left<0?-l.left:0,g=l.top<0?-l.top:0;d.drawImage(a,l.left+m,l.top+g,l.width,l.height,m*(h.width/l.width),g*(h.height/l.height),h.width,h.height)}(t,i,this.coordinates,s,n),t}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(t){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&e?$n(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,n=this.visibleArea&&e?Yt(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return jn({transform:t,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:n,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var t=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var e=this.defaultSize;e||(e=this.stencilSize?qn:Un);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var n=wt(e)?e({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):e,o=this.defaultPosition||Xn,s=[n,function(r){var h=r.coordinates;return S({},wt(o)?o({coordinates:h,imageSize:t.imageSize,visibleArea:t.visibleArea}):t.defaultPosition)}];this.delayedTransforms&&s.push.apply(s,gt(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(s,!0),this.delayedTransforms=null}},clearImage:function(){var t=this;this.imageLoaded=!1,setTimeout(function(){var e=t.$refs.stretcher;e&&(e.style.height="auto",e.style.width="auto"),t.coordinates=t.defaultCoordinates(),t.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var t=this,e=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:e,imageSize:this.imageSize}),this.$nextTick().then(function(){var n={cropper:i,imageSize:t.imageSize};if(wt(t.defaultBoundaries)?t.boundaries=t.defaultBoundaries(n):t.defaultBoundaries==="fit"?t.boundaries=function(o){var s=o.cropper,r=o.imageSize,h=s.clientHeight,a=s.clientWidth,l=h,c=r.width*h/r.height;return c>a&&(c=a,l=r.height*a/r.width),{width:c,height:l}}(n):t.boundaries=function(o){var s=o.cropper;return{width:s.clientWidth,height:s.clientHeight}}(n),!t.boundaries.width||!t.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var t=this;return this.appliedImageTransforms=S(S({},this.defaultImageTransforms),{},{flip:S({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){t.priority!=="visible-area"&&(t.visibleArea=null,t.resetCoordinates());var e,i,n,o,s,r,h=t.defaultVisibleArea||Zn;t.visibleArea=wt(h)?h({imageSize:t.imageSize,boundaries:t.boundaries,coordinates:t.priority!=="visible-area"?t.coordinates:null,getAreaRestrictions:t.getAreaRestrictions,stencilSize:t.getStencilSize()}):t.defaultVisibleArea,t.visibleArea=(e={visibleArea:t.visibleArea,boundaries:t.boundaries,getAreaRestrictions:t.getAreaRestrictions},i=e.visibleArea,n=e.boundaries,o=e.getAreaRestrictions,s=v({},i),r=R(n),s.width/s.height!==r&&(s.height=s.width/r),$(s,o({visibleArea:s,type:"move"}))),t.priority==="visible-area"?t.resetCoordinates():t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("resetVisibleArea")}).catch(function(){t.visibleArea=null})},updateVisibleArea:function(){var t=this;return this.updateBoundaries().then(function(){t.visibleArea=t.fitVisibleArea({imageSize:t.imageSize,boundaries:t.boundaries,visibleArea:t.visibleArea,coordinates:t.coordinates,getAreaRestrictions:t.getAreaRestrictions}),t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("updateVisibleArea")}).catch(function(){t.visibleArea=null})},onChange:function(){var t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];t&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var t,e=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(o){if(ui(o))return!1;var s=window.location,r=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(o)||[],h={protocol:r[1]||"",host:r[2]||"",port:r[3]||""},a=function(l){return l.port||((l.protocol||s.protocol)==="http"?80:433)};return!(!h.protocol&&!h.host&&!h.port||h.protocol&&h.protocol==s.protocol&&h.host&&h.host==s.host&&h.host&&a(h)==a(s))}(this.src)){var i=P(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var n=(t=this.src,new Promise(function(o){rs(t).then(function(s){var r=as(s);o(s?{source:t,arrayBuffer:s,orientation:r}:{source:t,arrayBuffer:null,orientation:null})}).catch(function(s){console.warn(s),o({source:t,arrayBuffer:null,orientation:null})})}));setTimeout(function(){n.then(e.onParseImage)},this.transitionTime)}else setTimeout(function(){e.onParseImage({source:e.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var t=this,e=this.$refs.image;e&&!this.imageLoaded&&(this.imageAttributes.height=e.naturalHeight,this.imageAttributes.width=e.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){t.$emit("ready"),t.onChange(!1)}))},onParseImage:function(t){var e=this,i=t.source,n=t.arrayBuffer,o=t.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,n&&o&&o>1?Ii(i)||!ui(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([n])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(s){for(var r=[],h=new Uint8Array(s);h.length>0;){var a=h.subarray(0,8192);r.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),h=h.subarray(8192)}return"data:image/jpeg;base64,"+btoa(r.join(""))}(n):this.imageAttributes.src=i,wt(this.defaultTransforms)?this.appliedImageTransforms=ue(this.defaultTransforms()):Gt(this.defaultTransforms)?this.appliedImageTransforms=ue(this.defaultTransforms):this.appliedImageTransforms=function(s){var r=ue({});if(s)switch(s){case 2:r.flip.horizontal=!0;break;case 3:r.rotate=-180;break;case 4:r.flip.vertical=!0;break;case 5:r.rotate=90,r.flip.vertical=!0;break;case 6:r.rotate=90;break;case 7:r.rotate=90,r.flip.horizontal=!0;break;case 8:r.rotate=-90}return r}(o),this.defaultImageTransforms=S(S({},this.appliedImageTransforms),{},{flip:S({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var s=e.$refs.image;s&&s.complete&&(function(r){return!!r.naturalWidth}(s)?e.onSuccessLoadImage():e.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(t){var e=this;this.transitionsOptions.enabled||this.awaitRender(function(){e.coordinates=e.moveAlgorithm(S(S({},e.getPublicProperties()),{},{positionRestrictions:Yt(e.positionRestrictions,e.visibleArea),coordinates:e.coordinates,event:e.normalizeEvent(t)})),e.onChange()})},onResize:function(t){var e=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=e.sizeRestrictions,n=Math.min(e.coordinates.width,e.coordinates.height,20*e.coefficient);e.coordinates=e.resizeAlgorithm(S(S({},e.getPublicProperties()),{},{positionRestrictions:Yt(e.positionRestrictions,e.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,e.visibleArea.width),maxHeight:Math.min(i.maxHeight,e.visibleArea.height),minWidth:Math.max(i.minWidth,n),minHeight:Math.max(i.minHeight,n)},event:e.normalizeEvent(t)})),e.onChange(),e.ticking=!1})},onManipulateImage:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=e.transitions,n=i!==void 0&&i,o=e.normalize,s=o===void 0||o;n&&this.enableTransitions();var r=Kn(S(S({},this.getPublicProperties()),{},{event:s?this.normalizeEvent(t):t,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),h=r.visibleArea,a=r.coordinates;this.visibleArea=h,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),n&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.visibleArea,i=t.type,n=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:e,type:n})},getAspectRatio:function(t){var e,i,n=this.stencilProps,o=n.aspectRatio,s=n.minAspectRatio,r=n.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var h=this.$refs.stencil.aspectRatios();e=h.minimum,i=h.maximum}if(P(e)&&(e=P(o)?s:o),P(i)&&(i=P(o)?r:o),!t&&(P(e)||P(i))){var a=this.getStencilSize(),l=a?R(a):null;P(e)&&(e=di(l)?l:void 0),P(i)&&(i=di(l)?l:void 0)}return{minimum:e,maximum:i}},getStencilSize:function(){if(this.stencilSize)return t={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},e=t.boundaries,i=t.stencilSize,n=t.aspectRatio,le(R(o=wt(i)?i({boundaries:e,aspectRatio:n}):i),n)&&(o=ot({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:o.width,height:o.height,aspectRatio:{minimum:n.minimum,maximum:n.maximum}})),(o.width>e.width||o.height>e.height)&&(o=ot({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:o.width,height:o.height,aspectRatio:{minimum:R(o),maximum:R(o)}})),o;var t,e,i,n,o},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return S({},fi)},flip:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,o=n===void 0||n;if(!this.transitionsActive){o&&this.enableTransitions();var s=S({},this.imageTransforms.flip),r=Qn({flip:{horizontal:t?!s.horizontal:s.horizontal,vertical:e?!s.vertical:s.vertical},previousFlip:s,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),h=r.visibleArea,a=r.coordinates;t&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),e&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=h,this.coordinates=a,this.onChange(),o&&this.debouncedDisableTransitions()}},rotate:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.transitions,n=i===void 0||i;if(!this.transitionsActive){n&&this.enableTransitions();var o=S({},this.imageSize);this.appliedImageTransforms.rotate+=t;var s=Gn({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:o,imageSize:this.imageSize,angle:t,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),r=s.visibleArea,h=s.coordinates,a=this.processAutoZoom("rotateImage",r,h);r=a.visibleArea,h=a.coordinates,this.visibleArea=r,this.coordinates=h,this.onChange(),n&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},ls={key:0,ref:"canvas",style:{display:"none"}},cs={key:1,ref:"sourceCanvas",style:{display:"none"}};Xi.render=function(t,e,i,n,o,s){return C(),O("div",{ref:"cropper",class:s.classes.cropper},[k("div",{ref:"stretcher",class:s.classes.stretcher},null,2),k("div",{class:s.classes.boundaries,style:s.boundariesStyle},[(C(),O(Qt(i.backgroundWrapperComponent),{class:s.classes.cropperWrapper,"wheel-resize":s.settings.resizeImage.wheel,"touch-resize":s.settings.resizeImage.touch,"touch-move":s.settings.moveImage.touch,"mouse-move":s.settings.moveImage.mouse,onMove:s.onManipulateImage,onResize:s.onManipulateImage},{default:et(function(){return[k("div",{class:s.classes.background,style:s.boundariesStyle},null,6),k("div",{class:s.classes.imageWrapper},[k("img",{ref:"image",crossorigin:o.imageAttributes.crossOrigin,src:o.imageAttributes.src,class:s.classes.image,style:s.imageStyle,onMousedown:e[1]||(e[1]=Ui(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),k("div",{class:s.classes.foreground,style:s.boundariesStyle},null,6),wi((C(),O(Qt(i.stencilComponent),zi({ref:"stencil",image:s.image,coordinates:o.coordinates,"stencil-coordinates":s.stencilCoordinates,transitions:s.transitionsOptions},i.stencilProps,{onResize:s.onResize,onResizeEnd:s.onResizeEnd,onMove:s.onMove,onMoveEnd:s.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[yi,o.imageLoaded]]),i.canvas?(C(),O("canvas",ls,null,512)):ft("",!0),i.canvas?(C(),O("canvas",cs,null,512)):ft("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const us=Ai({components:{Cropper:Xi},props:{file:{type:File,required:!0},aspectRatio:{type:Number,default:1/1},maxWidth:{type:Number,default:1024},maxSize:{type:Number,default:800*1024},autoZoom:{type:Boolean,default:!1}},setup(t){const{proxy:e}=Ei(),{file:i}=qi(t),n=at(null),o=at(""),s=at({width:0,height:0}),r=at({width:0,height:0}),h=at(!1),a={maxWidth:`${window.innerWidth-40}px`,maxHeight:`${window.innerHeight-127}px`},l=()=>{const p=e.$refs.cropper;if(p){const{image:b}=p.getResult();b&&p.setCoordinates({x:0,y:0,width:b.width,height:b.height})}},c=()=>{const p=e.$refs.cropper,{coordinates:b,image:E}=p.getResult();r.value.width=Math.round(b.width),r.value.height=Math.round(b.height),h.value||(s.value.width=Math.round(E.width),s.value.height=Math.round(E.height),h.value=!0)},u=()=>{const p=e.$refs.cropper;p&&r.value.width>0&&r.value.height>0&&p.setCoordinates({x:0,y:0,width:r.value.width,height:r.value.height})};Zi(()=>i,f=>{f&&(o.value=URL.createObjectURL(i.value))},{immediate:!0});const d=()=>{const f=e;o.value&&URL.revokeObjectURL(o.value),f.$emit("cancel")},m=async()=>{const f=e,p=n.value.getCanvas();if(p){const b=i.value.type,E=await g(p,b,f.maxSize),A=new File([E],i.value.name,{type:b});o.value&&URL.revokeObjectURL(o.value),f.$emit("confirm",A)}},g=async(f,p,b)=>{let E=1,A;do A=await new Promise(F=>f.toBlob(F,p,E)),E-=.1;while(A.size>b&&E>0);return A};return{style:a,fileUrl:o,cropSize:s,cropSizeModel:r,cropper:n,isInitCropSize:h,changeSize:u,onCancel:d,onConfirm:m,onCropChange:c,onCropperReady:l}}}),ds={key:0,class:"preview-modal"},fs={class:"modal-content"},ms={key:0,class:"flex flex-center info-image"},gs={class:"flex",style:{width:"100px"}},ps={class:"flex",style:{width:"100px"}},vs={class:"modal-actions"};function bs(t,e,i,n,o,s){const r=U("cropper"),h=U("ms-number"),a=U("ms-button");return t.file?(C(),ut("div",ds,[H("div",{class:"modal-overlay",onClick:e[0]||(e[0]=(...l)=>t.onCancel&&t.onCancel(...l))}),H("div",fs,[H("div",{class:"crop-container",style:Ki(t.style)},[k(r,{ref:"cropper",class:"cropper",src:t.fileUrl,"auto-zoom":t.autoZoom,onReady:t.onCropperReady,onChange:t.onCropChange},null,8,["src","auto-zoom","onReady","onChange"])],4),t.isInitCropSize?(C(),ut("div",ms,[H("div",gs,[k(h,{modelValue:t.cropSizeModel.width,"onUpdate:modelValue":e[1]||(e[1]=l=>t.cropSizeModel.width=l),onChange:t.changeSize,max:t.cropSize.width?t.cropSize.width:1e5,min:0},null,8,["modelValue","onChange","max"]),e[3]||(e[3]=H("span",null,"px",-1))]),e[5]||(e[5]=oe(" * ")),H("div",ps,[k(h,{modelValue:t.cropSizeModel.height,"onUpdate:modelValue":e[2]||(e[2]=l=>t.cropSizeModel.height=l),onChange:t.changeSize,max:t.cropSize.height?t.cropSize.height:1e5,min:0},null,8,["modelValue","onChange","max"]),e[4]||(e[4]=H("span",null,"px",-1))])])):ft("",!0),H("div",vs,[k(a,{style:{"margin-right":"12px"},onClick:t.onCancel},{default:et(()=>[oe(Le(t.$t("i18nCommon.Close")),1)]),_:1},8,["onClick"]),k(a,{class:"primary",onClick:t.onConfirm},{default:et(()=>[oe(Le(t.$t("i18nCommon.crud.save")),1)]),_:1},8,["onClick"])])])])):ft("",!0)}const ws=Si(us,[["render",bs],["__scopeId","data-v-567754e9"]]),ys={class:"ms-file-image p-upload_image"},zs=["onClick","src"],As={class:"image-tool"},Es=["onClick"],Ss=["onClick"],Rs={key:0,class:"image-item"},xs={class:"image-form"},Cs={class:"image-tool"},Ms=Ai({__name:"MsFileImage",props:{modelValue:{required:!0},multiple:{required:!1,default:!1},path:{required:!1,default:""},aspectRatio:{type:Number,default:1/1},maxWidth:{type:Number,default:1024},maxSize:{type:Number,default:800*1024},autoZoom:{type:Boolean,default:!1},isUploadKeepNameFile:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const{proxy:i}=Ei(),n=e,o=at(""),s=at(!1),r=at(null),h=g=>{const f=i;f.viewerInstance&&(f.viewerInstance.destroy(),f.viewerInstance=null),f.viewerInstance=new Ti(f.$refs[`${g}_image`][0],{inline:!1,toolbar:!0,navbar:!1}),f.viewerInstance.show()};Gi(()=>{const g=i;g.viewerInstance&&(g.viewerInstance.destroy(),g.viewerInstance=null)});const a=async g=>{let f=null;g.type==="change"&&g.target.files&&g.target.files.length>0&&(f=g.target.files[0]),f&&(r.value=f,s.value=!0)},l=()=>{const g=i;s.value=!1,r.value=null,g.$refs.refFile.value=null},c=async g=>{const f=i;s.value=!1,f.$ms.commonFn.mask();const p=await se.uploadFile(g,f.path,f.isUploadKeepNameFile);if(f.$ms.commonFn.unmask(),r.value=null,f.$refs.refFile.value=null,p!=null&&p.Success&&(p!=null&&p.Data))if(o.value){const b=u.value,E=b.findIndex(A=>A===o.value);E!==-1&&(b[E]=p.Data,n("update:modelValue",b.join(";"))),o.value=""}else{const b=u.value;b.push(p.Data),n("update:modelValue",b.join(";"))}},u=Qi(()=>{const g=i;return g.modelValue?g.modelValue.split(";"):[]}),d=(g="")=>{const f=i;f.$refs.refFile&&(f.$refs.refFile.click(),g&&(o.value=g))},m=async g=>{if(g&&await tn(i.$t("i18nCommon.AskDeleteRecord"))){const b=u.value.filter(E=>E!=g);n("update:modelValue",b.join(";")),se.deleteFile(g)}};return(g,f)=>(C(),ut("div",ys,[(C(!0),ut(fe,null,me(u.value,p=>(C(),ut("div",{class:"image-item",key:p},[H("div",{class:"image-form",ref_for:!0,ref:`${p}_image`},[p?(C(),ut("img",{key:0,onClick:b=>h(p),src:Ji(se).getFileViewUrl(p),class:"image-form-style",alt:""},null,8,zs)):ft("",!0)],512),H("div",As,[H("div",{onClick:b=>d(p),class:"image-tool_item tool-edit"},null,8,Es),f[2]||(f[2]=H("div",{class:"separate-line-upload"},null,-1)),H("div",{onClick:b=>m(p),class:"image-tool_item tool-delete"},null,8,Ss)])]))),128)),t.multiple||!u.value.length?(C(),ut("div",Rs,[H("div",xs,[H("div",{onClick:f[0]||(f[0]=p=>d()),class:"upload-image"})]),H("div",Cs,[H("div",{onClick:f[1]||(f[1]=p=>d()),class:"image-tool_item tool-edit"})])])):ft("",!0),H("input",{accept:"image/*",onChange:a,class:"separate-line-chose_image",ref:"refFile",type:"file"},null,544),s.value?(C(),O(ws,{key:1,file:r.value,aspectRatio:t.aspectRatio,maxWidth:t.maxWidth,maxSize:t.maxSize,autoZoom:t.autoZoom,onCancel:l,onConfirm:c},null,8,["file","aspectRatio","maxWidth","maxSize","autoZoom"])):ft("",!0)]))}}),Is=Si(Ms,[["__scopeId","data-v-ab32f8b3"]]);export{Is as M};
