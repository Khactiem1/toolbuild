import{d as w}from"./vuedraggable.umd-DLvMjPJ4.js";import{l as V}from"./layoutAPI-SPx1ej8s.js";import{d as $,g as P,r as y,c as M,a2 as C,_ as L,j as m,m as N,o as T,w as c,b as n,k as r,v,t as l,n as U,W as k,c5 as b}from"./index-DmUMvrSQ.js";const O=$({props:{},components:{draggable:w},setup(){const{proxy:o}=P(),a=y([]),f=y(!1),g=e=>{const s=o;s._popup=s.$vfm.dynamicModals[s.$vfm.dynamicModals.length-1],s._formParam=e.ref.params._rawValue?e.ref.params._rawValue:e.ref.params,s.editMode=s._formParam.formState,a.value=s._formParam.columns},_=async()=>{var s;const e=o;typeof((s=e._formParam)==null?void 0:s.initLayout)=="function"&&e._formParam.layoutTag&&(e._formParam.initLayout(a.value),C.set(`Layout${e._formParam.layoutTag}`,a.value),C.set(`Layout${e._formParam.layoutTag}Edit`,JSON.parse(JSON.stringify(a.value))),V.updateLayoutByTag(e._formParam.layoutTag,JSON.stringify(a.value))),h()},h=()=>{try{const e=o;e._popup.value=!1,e.$nextTick(()=>{delete e._popup})}catch(e){console.error(e)}},d=(e,s)=>{e=e||window.event;var t=e.which?e.which:e.keyCode;if(t>31&&(t<48||t>57||s>999)&&t!==46)e.preventDefault();else return!0},u=M(()=>!a.value.find(e=>!e.visible));return{columns:a,dragging:f,showAll:u,handleClickCheckAll:()=>{u.value?a.value.forEach(e=>{e.visible=!1}):a.value.forEach(e=>{e.visible=!0})},beforeOpen:g,isInputNumber:d,saveLayout:_}}}),A={class:"setting-content"},B={class:"setting-name setting-header_name"},S={style:{"padding-left":"26px"}},G={style:{"padding-left":"19px"},class:"info-setting"},I={class:"info-setting name-custom"},x={style:{"padding-left":"45px"}},E={style:{"padding-left":"45px"}},D=["title"],J={class:"info-setting"},z=["onUpdate:modelValue"],H=["onKeypress","onUpdate:modelValue"],K={class:"setting-footer"};function j(o,a,f,g,_,h){const d=m("ms-checkbox"),u=m("draggable"),p=m("ms-button"),e=m("ms-dynamic-popup");return T(),N(e,{dockPosition:"right",width:850,title:o.$t("i18nCommon.customize_interface"),onBeforeOpen:o.beforeOpen},{content:c(({close:s})=>[n("div",A,[n("div",B,[n("div",S,[r(d,{checked:o.showAll,onCustomHandleClickCheckbox:o.handleClickCheckAll},null,8,["checked","onCustomHandleClickCheckbox"])]),n("div",G,l(o.$t("i18nControl.MsGridViewer.name_column")),1),n("div",I,l(o.$t("i18nControl.MsGridViewer.name_column_custom")),1),n("div",x,l(o.$t("i18nControl.MsGridViewer.width")),1),n("div",E,l(o.$t("i18nControl.MsGridViewer.fixed_col")),1)]),r(u,{list:o.columns,disabled:!1,"item-key":"Field",class:"list-group","ghost-class":"ghost",onStart:a[0]||(a[0]=t=>o.dragging=!0),onEnd:a[1]||(a[1]=t=>o.dragging=!1)},{item:c(({element:t})=>[n("div",{class:U(["list-group-item setting-name",{"not-draggable":!1}])},[n("div",{title:o.$t("i18nControl.MsGridViewer.drag"),class:"icon-drag-grid"},null,8,D),r(d,{modelValue:t.visible,"onUpdate:modelValue":i=>t.visible=i},null,8,["modelValue","onUpdate:modelValue"]),n("div",J,l(o.$t(t.header)),1),k(n("input",{"onUpdate:modelValue":i=>t.headerCustom=i,class:"input input-setting",type:"text"},null,8,z),[[b,t.headerCustom]]),k(n("input",{onKeypress:i=>o.isInputNumber(i,t.width),"onUpdate:modelValue":i=>t.width=i,class:"input input-setting_width",type:"text"},null,40,H),[[b,t.width]]),r(d,{class:"fix-column",modelValue:t.lock,"onUpdate:modelValue":i=>t.lock=i},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["list"])])]),footer:c(({close:s})=>[n("div",K,[r(p,{onClick:s,class:"btn"},{default:c(()=>[v(l(o.$t("i18nCommon.Close")),1)]),_:2},1032,["onClick"]),r(p,{onClick:o.saveLayout,class:"btn primary"},{default:c(()=>[v(l(o.$t("i18nCommon.crud.save")),1)]),_:1},8,["onClick"])])]),_:1},8,["title","onBeforeOpen"])}const Q=L(O,[["render",j],["__scopeId","data-v-0d232e32"]]);export{Q as default};
